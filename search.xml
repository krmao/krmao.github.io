<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>移动端_IOS_SWIFT_4_0_ALAMOFILE_同步执行</title>
      <link href="/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_SWIFT_4_0_ALAMOFILE_%E5%90%8C%E6%AD%A5%E6%89%A7%E8%A1%8C/"/>
      <url>/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_SWIFT_4_0_ALAMOFILE_%E5%90%8C%E6%AD%A5%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">static func downloadByFullURLSync&lt;T: Codable&gt;(url: String, timeoutInterval: Double = 60) -&gt; T? &#123;</span><br><span class="line">    CXLogUtil.e(&quot;download 0 sync \(Thread.currentThread())&quot;)</span><br><span class="line">    let semaphore = DispatchSemaphore.init(value: 0)</span><br><span class="line"></span><br><span class="line">    var responseModel: T?</span><br><span class="line"></span><br><span class="line">    let start = Date()</span><br><span class="line">    Alamofire.download(URLRequest(url: NSURL.init(string: url)! as URL, timeoutInterval: timeoutInterval))</span><br><span class="line">        .responseJSON(queue: DispatchQueue.global(qos: DispatchQoS.QoSClass.background), options: .allowFragments, completionHandler:  &#123; dataResponse in</span><br><span class="line">                CXLogUtil.e(&quot;download 2 sync \(Thread.currentThread())&quot;)</span><br><span class="line"></span><br><span class="line">                print(&quot;\n\n&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;)</span><br><span class="line">                print(&quot;request url: &quot;, dataResponse.request?.url ?? &quot;&quot;)</span><br><span class="line">                print(&quot;\nrequest headers:\n&quot;)</span><br><span class="line">                dataResponse.request?.allHTTPHeaderFields?.forEach &#123; key, value in</span><br><span class="line">                    print(&quot;\t&quot;, key, value)</span><br><span class="line">                &#125;</span><br><span class="line">                print(&quot;\n&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;----------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot;)</span><br><span class="line">                print(&quot;response headers:\n&quot;)</span><br><span class="line">                dataResponse.response?.allHeaderFields.forEach &#123; key, value in</span><br><span class="line">                    print(&quot;\t&quot;, key, value)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                print(&quot;\nresponse body:\n\n\t\(dataResponse.result.value ?? &quot;&quot;)\n&quot;)</span><br><span class="line"></span><br><span class="line">                let ms = round(Date().timeIntervalSince(start) * 1000)</span><br><span class="line">                print(&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 耗时: \(ms) ms \n\n&quot;)</span><br><span class="line">                if (dataResponse.result.isSuccess &amp;&amp; dataResponse.result.value != nil) &#123;</span><br><span class="line">                    responseModel = CXJsonUtil.parse(T.self, withJSONObject: dataResponse.result.value ?? &quot;&quot;)</span><br><span class="line">                    print(&quot;\nresponse success:\n&quot;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    responseModel = nil</span><br><span class="line">                    let failureMessage = dataResponse.result.error?.localizedDescription.lowercased() ?? &quot;网络错误&quot;</span><br><span class="line">                    print(&quot;\nresponse failure:\n\n\t\(failureMessage)\n&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">                semaphore.signal()</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">    _ = semaphore.wait(timeout: DispatchTime.distantFuture)</span><br><span class="line">    CXLogUtil.e(&quot;download 1 sync \(Thread.currentThread())&quot;)</span><br><span class="line">    return responseModel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 移动端 </tag>
            
            <tag> IOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_ANDROID_SDK</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_ANDROID_SDK/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_ANDROID_SDK/</url>
      
        <content type="html"><![CDATA[<h1 id="1-下载地址-https-developer-android-com-studio-index-html-downloads"><a href="#1-下载地址-https-developer-android-com-studio-index-html-downloads" class="headerlink" title="1 下载地址 https://developer.android.com/studio/index.html#downloads"></a>1 下载地址 <a href="https://developer.android.com/studio/index.html#downloads" target="_blank" rel="noopener">https://developer.android.com/studio/index.html#downloads</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/packages/</span><br><span class="line">wget https://dl.google.com/android/repository/sdk-tools-linux-3859397.zip</span><br></pre></td></tr></table></figure><h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h1><ul><li><p>解压到指定目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unzip /opt/software/packages/sdk-tools-linux-3859397.zip -d /opt/software/sdks/android/sdk</span><br><span class="line">cd /opt/software/sdks/android/sdk/tools/bin</span><br></pre></td></tr></table></figure></li><li><p>检查需要安装的 sdk 版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Sdk and tools</span><br><span class="line">minSdkVersion = 15</span><br><span class="line">targetSdkVersion = 25</span><br><span class="line">compileSdkVersion = 27</span><br><span class="line">buildToolsVersion = &quot;27.0.3&quot;</span><br><span class="line"></span><br><span class="line">// App dependencies</span><br><span class="line">supportLibraryVersion = &quot;27.0.2&quot;</span><br><span class="line">constraintLayoutVersion = &quot;1.0.2&quot;</span><br><span class="line">multidex = &quot;1.0.2&quot;</span><br></pre></td></tr></table></figure></li><li><p>执行安装命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./sdkmanager --help</span><br><span class="line"></span><br><span class="line"># echo y | 通过管道模式直接确认,不需要等会儿手动输入 y 确认</span><br><span class="line">echo y | ./sdkmanager &quot;build-tools;27.0.3&quot; &quot;platforms;android-27&quot; &quot;platform-tools&quot; &quot;ndk-bundle&quot; &quot;extras;android;m2repository&quot; &quot;extras;google;m2repository&quot; &quot;extras;m2repository;com;android;support;constraint;constraint-layout;1.0.2&quot; &quot;tools&quot;</span><br></pre></td></tr></table></figure></li><li><p>默认安装的目录结构 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"># /opt/software/sdks/android/sdk</span><br><span class="line">[root@localhost android]# tree -L 3</span><br><span class="line">.</span><br><span class="line">└── sdk</span><br><span class="line">    ├── build-tools</span><br><span class="line">    │   └── 27.0.3</span><br><span class="line">    ├── emulator</span><br><span class="line">    │   ├── bin64</span><br><span class="line">    │   ├── emulator</span><br><span class="line">    │   ├── emulator64-arm</span><br><span class="line">    │   ├── emulator64-crash-service</span><br><span class="line">    │   ├── emulator64-mips</span><br><span class="line">    │   ├── emulator64-x86</span><br><span class="line">    │   ├── emulator-check</span><br><span class="line">    │   ├── lib</span><br><span class="line">    │   ├── lib64</span><br><span class="line">    │   ├── mksdcard</span><br><span class="line">    │   ├── NOTICE.txt</span><br><span class="line">    │   ├── package.xml</span><br><span class="line">    │   ├── qemu</span><br><span class="line">    │   ├── resources</span><br><span class="line">    │   └── source.properties</span><br><span class="line">    ├── extras</span><br><span class="line">    │   ├── android</span><br><span class="line">    │   ├── google</span><br><span class="line">    │   └── m2repository</span><br><span class="line">    ├── licenses</span><br><span class="line">    │   └── android-sdk-license</span><br><span class="line">    ├── ndk-bundle</span><br><span class="line">    │   ├── build</span><br><span class="line">    │   ├── CHANGELOG.md</span><br><span class="line">    │   ├── meta</span><br><span class="line">    │   ├── ndk-build</span><br><span class="line">    │   ├── ndk-depends</span><br><span class="line">    │   ├── ndk-gdb</span><br><span class="line">    │   ├── ndk-stack</span><br><span class="line">    │   ├── ndk-which</span><br><span class="line">    │   ├── package.xml</span><br><span class="line">    │   ├── platforms</span><br><span class="line">    │   ├── prebuilt</span><br><span class="line">    │   ├── python-packages</span><br><span class="line">    │   ├── README.md</span><br><span class="line">    │   ├── shader-tools</span><br><span class="line">    │   ├── simpleperf</span><br><span class="line">    │   ├── source.properties</span><br><span class="line">    │   ├── sources</span><br><span class="line">    │   ├── sysroot</span><br><span class="line">    │   └── toolchains</span><br><span class="line">    ├── patcher</span><br><span class="line">    │   └── v4</span><br><span class="line">    ├── platforms</span><br><span class="line">    │   └── android-27</span><br><span class="line">    ├── platform-tools</span><br><span class="line">    │   ├── adb</span><br><span class="line">    │   ├── api</span><br><span class="line">    │   ├── dmtracedump</span><br><span class="line">    │   ├── e2fsdroid</span><br><span class="line">    │   ├── etc1tool</span><br><span class="line">    │   ├── fastboot</span><br><span class="line">    │   ├── hprof-conv</span><br><span class="line">    │   ├── lib64</span><br><span class="line">    │   ├── make_f2fs</span><br><span class="line">    │   ├── mke2fs</span><br><span class="line">    │   ├── mke2fs.conf</span><br><span class="line">    │   ├── NOTICE.txt</span><br><span class="line">    │   ├── package.xml</span><br><span class="line">    │   ├── sload_f2fs</span><br><span class="line">    │   ├── source.properties</span><br><span class="line">    │   ├── sqlite3</span><br><span class="line">    │   └── systrace</span><br><span class="line">    └── tools</span><br><span class="line">        ├── android</span><br><span class="line">        ├── bin</span><br><span class="line">        ├── emulator</span><br><span class="line">        ├── emulator-check</span><br><span class="line">        ├── lib</span><br><span class="line">        ├── mksdcard</span><br><span class="line">        ├── monitor</span><br><span class="line">        ├── NOTICE.txt</span><br><span class="line">        ├── package.xml</span><br><span class="line">        ├── proguard</span><br><span class="line">        ├── source.properties</span><br><span class="line">        └── support</span><br><span class="line"></span><br><span class="line">38 directories, 42 files</span><br><span class="line">[root@localhost android]#</span><br></pre></td></tr></table></figure></li></ul><h1 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"># ANDROID_HOME START</span><br><span class="line">ANDROID_HOME=/opt/software/sdks/android/sdk</span><br><span class="line">PATH=$PATH:$ANDROID_HOME:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:ANDROID_HOME/emulator</span><br><span class="line">export ANDROID_HOME PATH</span><br><span class="line"># ANDROID_HOME END</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><ul><li><p>Unsupported major.minor version 52.0 <a href="https://www.jianshu.com/p/9cde35b7faba" target="_blank" rel="noopener">点击查看如何安装 JDK1.8</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 需要安装 jdk 1.8 版本</span><br><span class="line">JDK 1.8 = 52</span><br><span class="line">JDK 1.7 = 51</span><br><span class="line">JDK 1.6 = 50</span><br><span class="line">JDK 1.5 = 49</span><br><span class="line">JDK 1.4 = 48</span><br><span class="line">JDK 1.3 = 47</span><br><span class="line">JDK 1.2 = 46</span><br><span class="line">JDK 1.1 = 45</span><br></pre></td></tr></table></figure></li><li><p>编译 android 项目 报错 <strong>‘java.lang.RuntimeException: No server to serve request. Check logs for details.’</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># 仔细查看编译日志</span><br><span class="line">AAPT err(Facade for 232115523): /opt/software/sdks/android/sdk/build-tools/27.0.3/aapt: /lib64/libc.so.6: version `GLIBC_2.14&apos; not found (required by /opt/software/sdks/android/sdk/build-tools/27.0.3/aapt)</span><br><span class="line">AAPT err(Facade for 232115523): /opt/software/sdks/android/sdk/build-tools/27.0.3/aapt: /lib64/libc.so.6: version `GLIBC_2.14&apos; not found (required by /opt/software/sdks/android/sdk/build-tools/27.0.3/lib64/libc++.so)</span><br><span class="line"></span><br><span class="line"># 查看系统是否已经安装 glibc 2.14</span><br><span class="line">strings /lib64/libc.so.6 |grep GLIBC</span><br><span class="line"></span><br><span class="line"># 发现不包含 2.14, 安装 glibc 2.14 版本应该可以解决问题</span><br><span class="line">yum install gcc g++</span><br><span class="line"></span><br><span class="line">cd /opt/software/packages/ &amp;&amp; wget wget http://ftp.gnu.org/gnu/glibc/glibc-2.14.tar.gz</span><br><span class="line">tar zxvf glibc-2.14.tar.gz</span><br><span class="line">cd glibc-2.14</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">../configure –prefix=/opt/glibc-2.14</span><br><span class="line">make -j4</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line"># /opt/software/packages/glibc-2.14/build/elf/ldconfig: Can&apos;t open configuration file /opt/software/glibc-2.14/etc/ld.so.conf: No such file or directory</span><br><span class="line">cp /etc/ld.so.conf /opt/software/glibc-2.14/etc/</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line"># make install 最后报 ld.so.conf: No such file or directory</span><br><span class="line">mkdir -p $prefix/etc</span><br><span class="line">touch $prefix/etc/ld.so.conf</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line"># 重新查看系统是否已经安装 glibc 2.14</span><br><span class="line">strings /lib64/libc.so.6 |grep GLIBC</span><br><span class="line"># 我这里是仍然没有看到 2.14 :) 哈哈</span><br><span class="line"></span><br><span class="line"># 修改 aapt</span><br><span class="line">cd /opt/software/sdks/android/sdk/build-tools/27.0.3</span><br><span class="line">mv ./aapt ./aapt_</span><br><span class="line">vi ./aapt</span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line">export LD_LIBRARY_PATH=/opt/software/glibc_2_14/lib &amp;&amp; &quot;$0&quot;_ $@</span><br><span class="line"></span><br><span class="line">chmod +x ./aapt</span><br><span class="line"></span><br><span class="line"># 对 ./aapt2 也做相同的处理,因为发现有的时候编译使用的是 aapt, 有的时候使用的是 aapt2</span><br><span class="line"></span><br><span class="line"># 重新build android 项目</span><br><span class="line">./gradlew clean assembleDebug --stacktrace</span><br><span class="line"></span><br><span class="line"># 编译成功 !!!</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_JDK_1_8</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_JDK_1_8/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_JDK_1_8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-下载-JDK"><a href="#1-下载-JDK" class="headerlink" title="1 下载 JDK"></a>1 下载 <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">JDK</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/packages/</span><br><span class="line">wget --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; http://download.oracle.com/otn-pub/java/jdk/8u162-b12/0da788060d494f5095bf8624735fa2f1/jdk-8u162-linux-x64.tar.gz</span><br></pre></td></tr></table></figure><h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 卸载 centos 默认安装的 open jdk</span><br><span class="line">[root@localhost jdk]# rpm -qa | grep java</span><br><span class="line">java-1.7.0-openjdk-1.7.0.171-2.6.13.0.el6_9.x86_64</span><br><span class="line">tzdata-java-2018c-1.el6.noarch</span><br><span class="line">java-1.6.0-openjdk-1.6.0.41-1.13.13.1.el6_8.x86_64</span><br><span class="line">[root@localhost jdk]#</span><br><span class="line">[root@localhost jdk]# rpm -e --nodeps java-1.7.0-openjdk-1.7.0.171-2.6.13.0.el6_9.x86_64</span><br><span class="line">[root@localhost jdk]# rpm -e --nodeps tzdata-java-2018c-1.el6.noarch</span><br><span class="line">[root@localhost jdk]# rpm -e --nodeps java-1.6.0-openjdk-1.6.0.41-1.13.13.1.el6_8.x86_64</span><br><span class="line">[root@localhost jdk]# rpm -qa | grep java</span><br><span class="line">[root@localhost jdk]#</span><br><span class="line"></span><br><span class="line"># 安装 JDK 1.8</span><br><span class="line">mv jdk-8u161-linux-x64.tar.gz\?AuthParam\=1521635451_ad06a59373f1aebdda5baa55350799bd jdk-8u161.tar.gz</span><br><span class="line">tar -zxvf /opt/software/packages/jdk-8u161.tar.gz -C /opt/software/sdks/jdk/</span><br></pre></td></tr></table></figure><h1 id="3-配置环境变量"><a href="#3-配置环境变量" class="headerlink" title="3 配置环境变量"></a>3 配置环境变量</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># JAVA_HOME START</span><br><span class="line">JAVA_HOME=/opt/software/sdks/jdk/jdk1.8.0_161</span><br><span class="line">JRE_HOME=$JAVA_HOME/jre</span><br><span class="line">CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class="line">export JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br><span class="line"># JAVA_HOME END</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost jdk1.8.0_161]# java -version</span><br><span class="line">java version &quot;1.8.0_161&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_161-b12)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.161-b12, mixed mode)</span><br><span class="line">[root@localhost jdk1.8.0_161]#</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_NODE</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_NODE/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_NODE/</url>
      
        <content type="html"><![CDATA[<h1 id="1-下载地址-https-nodejs-org-en-download"><a href="#1-下载地址-https-nodejs-org-en-download" class="headerlink" title="1 下载地址 https://nodejs.org/en/download/"></a>1 下载地址 <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/packages/</span><br><span class="line">wget https://nodejs.org/dist/v8.10.0/node-v8.10.0-linux-x64.tar.xz</span><br></pre></td></tr></table></figure><h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf /opt/software/packages/node-v8.10.0-linux-x64.tar.xz -C /opt/software/</span><br><span class="line">cd /opt/software/node-v8.10.0-linux-x64/bin/ &amp;&amp; ls</span><br><span class="line">./node -v</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8.10.0</span><br></pre></td></tr></table></figure><h1 id="3-增加软连接-使得-node-npm-可以全局使用"><a href="#3-增加软连接-使得-node-npm-可以全局使用" class="headerlink" title="3 增加软连接,使得 node/npm 可以全局使用"></a>3 增加软连接,使得 node/npm 可以全局使用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s /opt/software/node-v8.10.0-linux-x64/bin/node /usr/local/bin/node</span><br><span class="line">ln -s /opt/software/node-v8.10.0-linux-x64/bin/npm /usr/local/bin/npm</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 测试</span><br><span class="line">cd /home &amp;&amp; node -v &amp;&amp; npm -v</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v8.10.0</span><br><span class="line">5.6.0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_ROCKET_MQ</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_ROCKET_MQ/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_ROCKET_MQ/</url>
      
        <content type="html"><![CDATA[<h1 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h1><ul><li><a href="http://rocketmq.apache.org/docs/quick-start/" target="_blank" rel="noopener">官方文档</a></li><li><a href="https://blog.csdn.net/u013680938/article/details/53447996" target="_blank" rel="noopener">参考文档</a></li></ul><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 64bit OS, Linux/Unix/Mac is recommended</span><br><span class="line"># install 64bit JDK 1.8+</span><br><span class="line"># install Maven 3.2.x</span><br><span class="line"></span><br><span class="line">yum install git</span><br><span class="line"></span><br><span class="line">cd /opt/software</span><br><span class="line">git clone -b release-4.2.0 https://github.com/apache/rocketmq.git</span><br><span class="line">cd rocketmq</span><br><span class="line">mvn -Prelease-all -DskipTests clean install -U</span><br></pre></td></tr></table></figure><ul><li>环境变量<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ROCKETMQ_HOME</span><br><span class="line">ROCKETMQ_HOME=/opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line"></span><br><span class="line"># MAVEN_HOME</span><br><span class="line">MAVEN_HOME=/opt/software/apache-maven-3.5.3</span><br><span class="line"></span><br><span class="line"># JAVA_HOME START</span><br><span class="line">JAVA_HOME=/opt/software/sdks/jdk/jdk1.8.0_162</span><br><span class="line">JRE_HOME=$JAVA_HOME/jre</span><br><span class="line">CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$MAVEN_HOME/bin:$ROCKETMQ_HOME:$ROCKETMQ_HOME/bin</span><br><span class="line">export JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br><span class="line"># JAVA_HOME END</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h1 id="Start-Name-Server"><a href="#Start-Name-Server" class="headerlink" title="Start Name Server"></a>Start Name Server</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line">&gt; nohup sh bin/mqnamesrv &amp;</span><br><span class="line">&gt; tail -f ~/logs/rocketmqlogs/namesrv.log</span><br><span class="line">The Name Server boot success...</span><br></pre></td></tr></table></figure><h1 id="Start-Broker"><a href="#Start-Broker" class="headerlink" title="Start Broker"></a>Start Broker</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line">&gt; nohup sh bin/mqbroker -n localhost:9876 &amp;</span><br><span class="line">&gt; tail -f ~/logs/rocketmqlogs/broker.log </span><br><span class="line">The broker[%s, 172.30.30.233:10911] boot success...</span><br></pre></td></tr></table></figure><h1 id="Shutdown-Servers"><a href="#Shutdown-Servers" class="headerlink" title="Shutdown Servers"></a>Shutdown Servers</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line">&gt; sh bin/mqshutdown broker</span><br><span class="line">The mqbroker(36695) is running...</span><br><span class="line">Send shutdown request to mqbroker(36695) OK</span><br><span class="line"></span><br><span class="line">&gt; sh bin/mqshutdown namesrv</span><br><span class="line">The mqnamesrv(36664) is running...</span><br><span class="line">Send shutdown request to mqnamesrv(36664) OK</span><br></pre></td></tr></table></figure><h1 id="Send-amp-Receive-Messages"><a href="#Send-amp-Receive-Messages" class="headerlink" title="Send &amp; Receive Messages"></a>Send &amp; Receive Messages</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd /opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line">&gt; export NAMESRV_ADDR=localhost:9876</span><br><span class="line">&gt; sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer</span><br><span class="line">SendResult [sendStatus=SEND_OK, msgId= ...</span><br><span class="line"></span><br><span class="line">&gt; cd /opt/software/rocketmq/distribution/target/apache-rocketmq</span><br><span class="line">&gt; sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer</span><br><span class="line">ConsumeMessageThread_%d Receive New Messages: [MessageExt...</span><br></pre></td></tr></table></figure><h1 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 开放 9876 端口</span><br></pre></td></tr></table></figure><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><ul><li><p>启动 Name Server 和 Broker 的时候 报内存不足</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“VM warning: INFO: OS::commit_memory(0x00000006c0000000, 2147483648, 0) faild; error=’Cannot allocate memory’ (errno=12)”</span><br></pre></td></tr></table></figure></li><li><p>解决方案：修改/RocketMQ/devnev/bin/ 下的服务启动脚本 runserver.sh 、runbroker.sh 中对于内存的限制，​改成如下示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -server -Xms128m -Xmx128m -Xmn128m -XX:PermSize=128m -XX:MaxPermSize=128m&quot;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_TOMCAT</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_TOMCAT/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_TOMCAT/</url>
      
        <content type="html"><![CDATA[<h1 id="1-下载-tomcat"><a href="#1-下载-tomcat" class="headerlink" title="1 下载 tomcat"></a>1 下载 <a href="https://tomcat.apache.org" target="_blank" rel="noopener">tomcat</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/software/packages</span><br><span class="line">wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.29/bin/apache-tomcat-8.5.29.tar.gz</span><br><span class="line">tar -xzvf /opt/software/packages/apache-tomcat-8.5.29.tar.gz -C /opt/software/</span><br></pre></td></tr></table></figure><h1 id="2-启动-tomcat"><a href="#2-启动-tomcat" class="headerlink" title="2 启动 tomcat"></a>2 启动 tomcat</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/software/apache-tomcat-8.5.29/bin/startup.sh</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Using CATALINA_BASE:   /opt/software/apache-tomcat-8.5.29</span><br><span class="line">Using CATALINA_HOME:   /opt/software/apache-tomcat-8.5.29</span><br><span class="line">Using CATALINA_TMPDIR: /opt/software/apache-tomcat-8.5.29/temp</span><br><span class="line">Using JRE_HOME:        /usr</span><br><span class="line">Using CLASSPATH:       /opt/software/apache-tomcat-8.5.29/bin/bootstrap.jar:/opt/software/apache-tomcat-8.5.29/bin/tomcat-juli.jar</span><br><span class="line">Tomcat started.</span><br></pre></td></tr></table></figure><h1 id="3-访问-tomcat"><a href="#3-访问-tomcat" class="headerlink" title="3 访问 tomcat"></a>3 访问 tomcat</h1><p>在浏览器中输入地址 <a href="http://10.10.10.10:8080" target="_blank" rel="noopener">http://10.10.10.10:8080</a> 注意tomcat默认监听8080端口<br><img src="https://upload-images.jianshu.io/upload_images/2062311-09ee7dd56abb46e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><h1 id="4-配置端口tomcat默认端口8080-为服务器默认的-80-端口"><a href="#4-配置端口tomcat默认端口8080-为服务器默认的-80-端口" class="headerlink" title="4 配置端口tomcat默认端口8080 为服务器默认的 80 端口"></a>4 配置端口tomcat默认端口8080 为服务器默认的 80 端口</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 1024以下的端口只能由root用户使用，普通权限的tomcat服使用80端口启动时会报没有权限</span><br><span class="line"># 以下方法为重定向 80 端口 到 8080, 避免了权限问题</span><br><span class="line">iptables -t nat -A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080  </span><br><span class="line">iptables -t nat -A PREROUTING -p udp -m udp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">service iptables save</span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 或者</span><br><span class="line">vi /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line">-A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">-A PREROUTING -p udp -m udp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line"></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在浏览器中访问 http://10.10.10.10:80</span><br></pre></td></tr></table></figure><h1 id="5-开机自启"><a href="#5-开机自启" class="headerlink" title="5 开机自启"></a>5 开机自启</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/rc.d/rc.local</span><br><span class="line">vi /etc/rc.d/rc.local</span><br><span class="line"># 在最下面添加</span><br><span class="line">/opt/software/apache-tomcat-8.5.29/bin/startup.sh</span><br></pre></td></tr></table></figure><h1 id="6-常用的防火墙配置"><a href="#6-常用的防火墙配置" class="headerlink" title="6 常用的防火墙配置"></a>6 常用的防火墙配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#iptables-save v1.4.7 on Wed Mar 21 13:50:00 2018</span><br><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 8000 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 7777 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 8888 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 8080 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 27017 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 21&quot; -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate RELATED,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 20&quot; -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 10060:10090 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 21&quot; -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 20&quot; -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m state --state NEW -m tcp --sport 10060:10090 -j ACCEPT</span><br><span class="line">-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">COMMIT</span><br><span class="line"># Completed on Wed Mar 21 13:50:00 2018</span><br><span class="line"></span><br><span class="line">*nat</span><br><span class="line">:PREROUTING ACCEPT [0:0]</span><br><span class="line">:POSTROUTING ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">-A PREROUTING -p udp -m udp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure><h1 id="7-tomcat-webapps-目录启用软连接文件夹"><a href="#7-tomcat-webapps-目录启用软连接文件夹" class="headerlink" title="7 tomcat webapps 目录启用软连接文件夹"></a>7 tomcat webapps 目录启用软连接文件夹</h1><ul><li>修改 conf/context.xml<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Default set of monitored resources. If one of these changes, the    --&gt;</span><br><span class="line">    &lt;!-- web application will be reloaded.                                   --&gt;</span><br><span class="line">    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;</span><br><span class="line">    &lt;WatchedResource&gt;$&#123;catalina.base&#125;/conf/web.xml&lt;/WatchedResource&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Uncomment this to disable session persistence across Tomcat restarts --&gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">    &lt;Manager pathname=&quot;&quot; /&gt;</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;Resources allowLinking=&quot;true&quot;/&gt; # 加上这句话即可, 注:java 对文件夹软链接的访问使用 &apos;dir.canonicalFile&apos;</span><br><span class="line">&lt;/Context&gt;</span><br></pre></td></tr></table></figure></li></ul><h1 id="8-tomcat-指定默认的启动工程"><a href="#8-tomcat-指定默认的启动工程" class="headerlink" title="8 tomcat 指定默认的启动工程"></a>8 tomcat 指定默认的启动工程</h1><ul><li>修改 /conf/server.xml</li></ul><ol><li>当appBase采用相对路径时，其父路径是tomcat的安装目录。即：/opt/software/apache-tomcat-8.5.29<br>如：appBase = “/webapps” 或 appBase = “webapps” 相当于 appBase = “/opt/software/apache-tomcat-8.5.29/webapps/”</li><li>当appBase使用绝对路径时，显然不需要注意什么，这也是推荐的写法。</li><li>当docBase采用相对路径时，其父路径是appBase的路径。即：/opt/software/apache-tomcat-8.5.29<br>如：docBase = “/template”或docBase = “template”相当于 docBase = “/opt/software/apache-tomcat-8.5.29/template”</li><li>特别的，路径显然只能指向某一文件夹，而不能具体的指向某个文件或是图片资源什么的。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot;</span><br><span class="line">      unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">  # 加上这句话即可</span><br><span class="line">  &lt;Context path=&quot;&quot; reloadable=&quot;true&quot; debug=&quot;5&quot; docBase=&quot;template&quot; /&gt; </span><br><span class="line"></span><br><span class="line">  &lt;!-- SingleSignOn valve, share authentication between web applications</span><br><span class="line">       Documentation at: /docs/config/valve.html --&gt;</span><br><span class="line">  &lt;!--</span><br><span class="line">  &lt;Valve className=&quot;org.apache.catalina.authenticator.SingleSignOn&quot; /&gt;</span><br><span class="line">  --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- Access log processes all example.</span><br><span class="line">       Documentation at: /docs/config/valve.html</span><br><span class="line">       Note: The pattern used is equivalent to using pattern=&quot;common&quot; --&gt;</span><br><span class="line">  &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;</span><br><span class="line">         prefix=&quot;localhost_access_log&quot; suffix=&quot;.txt&quot;</span><br><span class="line">         pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure></li></ol><p>#9 由 tomcat 导致的中文乱码问题</p><ul><li><p>首先确保 html 文件本身是 UTF-8 编码, 并且在 html 代码中设置编码格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br></pre></td></tr></table></figure></li><li><p>测试本地正常, 但是经过tomcat 中转后出现中文乱码, 尤其是纯英文的操作系统, 部分电脑正常部分电脑乱码, 有的电脑谷歌浏览器乱码但是火狐浏览器正常, 针对谷歌浏览器有一个临时解决方案,将 <strong>设置-&gt;高级-&gt;语言-&gt;中文（简体)</strong> 排序到最顶部 可以临时解决乱码</p></li><li><p>修改 /conf/server.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">           connectionTimeout=&quot;20000&quot;</span><br><span class="line">           redirectPort=&quot;8443&quot;</span><br><span class="line">           URIEncoding=&quot;UTF-8&quot; /&gt;</span><br></pre></td></tr></table></figure></li><li><p>如果上述修改不起作用, 则需要在 spring boot 项目中增加静态资源过滤器,强制设置静态资源编码为 UTF-8</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.smart.template.base.config.filter</span><br><span class="line"></span><br><span class="line">import org.slf4j.LoggerFactory</span><br><span class="line">import org.springframework.core.annotation.Order</span><br><span class="line">import org.springframework.web.servlet.resource.ResourceUrlEncodingFilter</span><br><span class="line">import springfox.documentation.annotations.ApiIgnore</span><br><span class="line">import javax.servlet.FilterChain</span><br><span class="line">import javax.servlet.ServletRequest</span><br><span class="line">import javax.servlet.ServletResponse</span><br><span class="line">import javax.servlet.annotation.WebFilter</span><br><span class="line">import javax.servlet.http.HttpServletRequest</span><br><span class="line"></span><br><span class="line">@ApiIgnore</span><br><span class="line">@Order(1)</span><br><span class="line">@WebFilter(filterName = &quot;static-filter&quot;, urlPatterns = arrayOf(&quot;/*&quot;)) //拦截器拦截的是域名+端口相同的路径</span><br><span class="line">class CXResourceUrlFilter : ResourceUrlEncodingFilter() &#123;</span><br><span class="line"></span><br><span class="line">    private val log = LoggerFactory.getLogger(this.javaClass)</span><br><span class="line"></span><br><span class="line">    override fun doFilter(request: ServletRequest?, response: ServletResponse?, filterChain: FilterChain?) &#123;</span><br><span class="line">        val httpRequest = request as HttpServletRequest</span><br><span class="line">        log.error(&quot;----------&gt;doFilter start($&#123;response?.contentType&#125;) &quot; + httpRequest.requestURI)</span><br><span class="line">        response?.contentType = &quot;UTF-8&quot;</span><br><span class="line"></span><br><span class="line">        super.doFilter(request, response, filterChain)</span><br><span class="line">        log.error(&quot;----------&gt;doFilter end($&#123;response?.contentType&#125;) &quot; + httpRequest.requestURI)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>虽然设置过滤器解决了乱码问题, 比如通过访问 <a href="http://10.47.12.111/index.html" target="_blank" rel="noopener">http://10.47.12.111/index.html</a> 已经显示正常, 但是如果是项目的默认首页, 比如通过访问  <a href="http://10.47.12.111" target="_blank" rel="noopener">http://10.47.12.111</a> 就可以看到<br>index.html  所展示的页面<em>(只要将 index.html 放到 src/main/resources/public/ 目录下即可实现在 url 中不加 <strong>/index.html</strong> 也可访问到页面)</em>, 由于 url  <a href="http://10.47.12.111" target="_blank" rel="noopener">http://10.47.12.111</a>  中没有path 所以无法被上一步骤的拦截器所拦截, 此时还有一个冷门却有效的做法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;mime-mapping&gt; </span><br><span class="line">       &lt;extension&gt;html&lt;/extension&gt; </span><br><span class="line">       &lt;mime-type&gt;text/html;charset=utf-8&lt;/mime-type&gt; </span><br><span class="line">&lt;/mime-mapping&gt;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_用户组管理</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_%E7%94%A8%E6%88%B7%E7%BB%84%E7%AE%A1%E7%90%86/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_%E7%94%A8%E6%88%B7%E7%BB%84%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># 新增用户组</span><br><span class="line">groupadd dev</span><br><span class="line"></span><br><span class="line"># 新增用户并添加到用户组</span><br><span class="line">useradd -g dev user_name</span><br><span class="line"></span><br><span class="line"># 为新增的用户修改密码</span><br><span class="line">echo &quot;123456&quot; | passwd --stdin user_name</span><br><span class="line"></span><br><span class="line">Changing password for user user_name.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line"></span><br><span class="line"># 查看用户所属的组</span><br><span class="line">groups user_name</span><br><span class="line"></span><br><span class="line"># 查看用户信息</span><br><span class="line">id user_name</span><br><span class="line"></span><br><span class="line"># 从组中删除用户</span><br><span class="line">gpasswd dev -d user_name</span><br><span class="line"></span><br><span class="line">Removing user user_name from group dev</span><br><span class="line">gpasswd: user &apos;user_name&apos; is not a member of &apos;dev&apos;</span><br><span class="line"></span><br><span class="line"># 添加已有用户到组</span><br><span class="line">gpasswd dev -a user_name</span><br><span class="line"></span><br><span class="line">Adding user user_name to group dev</span><br><span class="line"></span><br><span class="line"># 永久删除用户</span><br><span class="line">userdel user_name</span><br><span class="line">gpasswd dev -d user_name</span><br><span class="line"># 同时删除该用户所有数据</span><br><span class="line">rm -rf /home/user_name</span><br><span class="line"></span><br><span class="line"># 给用户添加 sudo 权限(为了方便大佬)</span><br><span class="line">vi /etc/sudoers</span><br><span class="line"># 找到 root    ALL=(ALL)       ALL 这一行,在下面添加  user_name    ALL=(ALL)       ALL </span><br><span class="line"></span><br><span class="line">## Allow root to run any commands anywhere</span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">user_name    ALL=(ALL)       ALL</span><br><span class="line">user_name_1    ALL=(ALL)       ALL</span><br><span class="line">user_name_2    ALL=(ALL)       ALL</span><br><span class="line"></span><br><span class="line">wq! 保存即可</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_系统新装</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_%E7%B3%BB%E7%BB%9F%E6%96%B0%E8%A3%85/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_%E7%B3%BB%E7%BB%9F%E6%96%B0%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h3 id="1-升级"><a href="#1-升级" class="headerlink" title="1 升级"></a>1 升级</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum upgrade -y</span><br></pre></td></tr></table></figure><h5 id="关于-upgrade-与-update-参考大神见解"><a href="#关于-upgrade-与-update-参考大神见解" class="headerlink" title="关于 upgrade 与 update 参考大神见解"></a><a href="https://segmentfault.com/q/1010000011264410" target="_blank" rel="noopener">关于 upgrade 与 update 参考大神见解</a></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">其实我更推荐用yum upgrade取代yum update，yum update只更新系统中已有的软件包，不会更新内核软件包(kernel-这个包)，yum upgrade是更彻底的update，会分析包的废弃关系，可以跨小版本升级（比如从centos 7.1升级到centos 7.4），除了做了yum update完全相同的事之外，还会更新kernel-的包，也会卸载掉已经废弃的包。</span><br><span class="line"></span><br><span class="line">新部署系统需要yum update/upgrade是因为yum不会给你解决依赖冲突(但是apt会)。</span><br><span class="line"></span><br><span class="line">举个例子，你的系统中已经安装了kernel-2.6.32.500，但是你要安装的某个软件包依赖于kernel-2.6.32.600，此时yum会报错退出，告诉你依赖不满足，并不会升级kernel包(只是举个例子而已，实际上几乎没有软件包直接依赖于kernel包)，所以你只能yum update/upgrade一次，把系统中所有的软件包全部更新，这样满足新部署的软件包的依赖。</span><br><span class="line"></span><br><span class="line">在debian/ubuntu的系统中，apt会对这种情况自动处理，会自动升级依赖的软件包。</span><br><span class="line"></span><br><span class="line">换句话来说，对于新部署的服务器，也是推荐upgrade全部的软件包，已获得最新的安全补丁。即使对于已经上线的服务器，也是推荐定期打安全漏洞补丁，减少漏洞带来的侵害。</span><br></pre></td></tr></table></figure><h3 id="2-不能-ping通-解析-域名-但是能-ping通-ip-参考链接"><a href="#2-不能-ping通-解析-域名-但是能-ping通-ip-参考链接" class="headerlink" title="2 不能 ping通* (解析)域名,但是能 ping通 ip 参考链接"></a>2 不能 <strong>ping通*</strong> (解析)域名,但是能 <strong>ping通</strong> ip <a href="https://newbug.top/centos%E4%B8%8D%E8%83%BD%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D/" target="_blank" rel="noopener">参考链接</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"></span><br><span class="line"># 在文件的最后加上dns的设置比如：DNS1=8.8.8.8</span><br><span class="line"># 114.114.114.114和8.8.8.8，这两个DNS都可以，不用担心因ISP运营商导致的DNS劫持等问题，而且都是免费提供给用户使用的。</span><br><span class="line"># 114.114.114.114是国内移动、电信和联通通用的DNS，如果你的服务器位于海外，建议使用谷歌的DNS</span><br><span class="line"># 8.8.8.8是谷歌提供的DNS，该地址是全球通用的，如果你的服务器位于大陆，请不要使用。</span><br><span class="line"></span><br><span class="line">DNS1=8.8.8.8</span><br><span class="line"></span><br><span class="line"># 重启网卡</span><br><span class="line">sudo service network restart</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>服务端_SPRING_BOOT_KOTLIN_MYBATIS_COMMON_SQL_PROVIDER</title>
      <link href="/2018/11/19/%E6%9C%8D%E5%8A%A1%E7%AB%AF_SPRING_BOOT_KOTLIN_MYBATIS_COMMON_SQL_PROVIDER/"/>
      <url>/2018/11/19/%E6%9C%8D%E5%8A%A1%E7%AB%AF_SPRING_BOOT_KOTLIN_MYBATIS_COMMON_SQL_PROVIDER/</url>
      
        <content type="html"><![CDATA[<h3 id="公共接口"><a href="#公共接口" class="headerlink" title="公共接口"></a>公共接口</h3><p>发现书写 mapper对数据库进行增删改查 以及 controller 都是重复性操作，才有了本编文章，主要是利用反射自动生成 SQL 增删改查语句</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.ibatis.annotations.DeleteProvider</span><br><span class="line">import org.apache.ibatis.annotations.InsertProvider</span><br><span class="line">import org.apache.ibatis.annotations.Options</span><br><span class="line">import org.apache.ibatis.annotations.UpdateProvider</span><br><span class="line"></span><br><span class="line">interface HKBaseMapper&lt;T&gt; &#123;</span><br><span class="line">    @Options(useGeneratedKeys = true)</span><br><span class="line">    @InsertProvider(type = HKSqlProvider::class, method = &quot;insert&quot;)</span><br><span class="line">    fun insert(tableModel: T): Int</span><br><span class="line"></span><br><span class="line">    @DeleteProvider(type = HKSqlProvider::class, method = &quot;delete&quot;)</span><br><span class="line">    fun delete(tableModel: T): Int</span><br><span class="line"></span><br><span class="line">    @UpdateProvider(type = HKSqlProvider::class, method = &quot;update&quot;)</span><br><span class="line">    fun update(tableModel: T): Int</span><br><span class="line"></span><br><span class="line">    @SelecProvider(type = HKSqlProvider::class, method = &quot;select&quot;)</span><br><span class="line">    fun select(tableModel: T): MutableList&lt;T&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.ibatis.annotations.Mapper</span><br><span class="line"></span><br><span class="line">@Mapper</span><br><span class="line">interface AdMapper : HKBaseMapper&lt;AdModel&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.logging.log4j.LogManager</span><br><span class="line">import org.apache.logging.log4j.Logger</span><br><span class="line"></span><br><span class="line">@Suppress(&quot;unused&quot;)</span><br><span class="line">class HKSqlProvider &#123;</span><br><span class="line">    private val logger: Logger = LogManager.getLogger(UserController::class.java.name)</span><br><span class="line"></span><br><span class="line">    fun insert(tableModel: Any?): String &#123;</span><br><span class="line">        val tableName = tableModel?.javaClass?.simpleName?.replace(&quot;Model&quot;, &quot;&quot;)?.toLowerUnderScoreFromUpperCamel()</span><br><span class="line">        val modelFields = HKReflectUtil.getFields(tableModel?.javaClass)</span><br><span class="line">        val valueNameList = ArrayList&lt;String&gt;()</span><br><span class="line">        val sqlString = StringBuilder(&quot;insert into $tableName (&quot;)</span><br><span class="line">        modelFields.forEach &#123; field -&gt; HKReflectUtil.getValue(field, tableModel)?.let &#123; valueNameList.add(field.name) &#125; &#125;</span><br><span class="line">        valueNameList.forEachIndexed &#123; index, valueName -&gt; sqlString.append(valueName).append(if (index != valueNameList.size - 1) &quot;,&quot; else &quot;) values(&quot;) &#125;</span><br><span class="line">        valueNameList.forEachIndexed &#123; index, valueName -&gt; sqlString.append(&quot;#&#123;$valueName&#125;&quot;).append(if (index != valueNameList.size - 1) &quot;,&quot; else &quot;)&quot;) &#125;</span><br><span class="line"></span><br><span class="line">        logger.warn(&quot;&quot;&quot;</span><br><span class="line">            ---------------------------------</span><br><span class="line">            mybatis-buildSql-insert --&gt;</span><br><span class="line">            tableModel: $tableModel</span><br><span class="line">                   sql: $sqlString</span><br><span class="line">            ---------------------------------</span><br><span class="line">        &quot;&quot;&quot;)</span><br><span class="line">        return sqlString.toString()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun update(tableModel: Any?): String &#123;</span><br><span class="line">        val tableName = tableModel?.javaClass?.simpleName?.replace(&quot;Model&quot;, &quot;&quot;)?.toLowerUnderScoreFromUpperCamel()</span><br><span class="line">        val modelFields = HKReflectUtil.getFields(tableModel?.javaClass)</span><br><span class="line">        val valueNameList = ArrayList&lt;String&gt;()</span><br><span class="line">        val sqlString = StringBuilder(&quot;update $tableName set &quot;)</span><br><span class="line">        modelFields.forEach &#123; field -&gt; HKReflectUtil.getValue(field, tableModel)?.let &#123; valueNameList.add(field.name) &#125; &#125;</span><br><span class="line">        valueNameList.forEachIndexed &#123; index, valueName -&gt; sqlString.append(&quot;$valueName=#&#123;$valueName&#125;&quot;).append(if (index != valueNameList.size - 1) &quot;,&quot; else &quot;&quot;) &#125;</span><br><span class="line"></span><br><span class="line">        logger.warn(&quot;&quot;&quot;</span><br><span class="line">            ---------------------------------</span><br><span class="line">            mybatis-buildSql-update --&gt;</span><br><span class="line">            tableModel: $tableModel</span><br><span class="line">                   sql: $sqlString</span><br><span class="line">            ---------------------------------</span><br><span class="line">        &quot;&quot;&quot;)</span><br><span class="line">        return sqlString.toString()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun delete(tableModel: Any?): String &#123;</span><br><span class="line">        val tableName = tableModel?.javaClass?.simpleName?.replace(&quot;Model&quot;, &quot;&quot;)?.toLowerUnderScoreFromUpperCamel()</span><br><span class="line">        val modelFields = HKReflectUtil.getFields(tableModel?.javaClass)</span><br><span class="line">        val valueNameList = ArrayList&lt;String&gt;()</span><br><span class="line">        val sqlString = StringBuilder(&quot;delete from $tableName where &quot;)</span><br><span class="line">        modelFields.forEach &#123; field -&gt; HKReflectUtil.getValue(field, tableModel)?.let &#123; valueNameList.add(field.name) &#125; &#125;</span><br><span class="line">        valueNameList.forEachIndexed &#123; index, valueName -&gt; sqlString.append(&quot;$valueName=#&#123;$valueName&#125;&quot;).append(if (index != valueNameList.size - 1) &quot; and &quot; else &quot;&quot;) &#125;</span><br><span class="line"></span><br><span class="line">        logger.warn(&quot;&quot;&quot;</span><br><span class="line">            ---------------------------------</span><br><span class="line">            mybatis-buildSql-delete --&gt;</span><br><span class="line">            tableModel: $tableModel</span><br><span class="line">                   sql: $sqlString</span><br><span class="line">            ---------------------------------</span><br><span class="line">        &quot;&quot;&quot;)</span><br><span class="line">        return sqlString.toString()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun select(tableModel: Any?): String &#123;</span><br><span class="line">        val tableName = tableModel?.javaClass?.simpleName?.replace(&quot;Model&quot;, &quot;&quot;)?.toLowerUnderScoreFromUpperCamel()</span><br><span class="line">        val modelFields = HKReflectUtil.getFields(tableModel?.javaClass)</span><br><span class="line">        val valueNameList = ArrayList&lt;String&gt;()</span><br><span class="line">        val sqlString = StringBuilder(&quot;select * from $tableName where &quot;)</span><br><span class="line">        modelFields.forEach &#123; field -&gt; HKReflectUtil.getValue(field, tableModel)?.let &#123; valueNameList.add(field.name) &#125; &#125;</span><br><span class="line">        valueNameList.forEachIndexed &#123; index, valueName -&gt; sqlString.append(&quot;$valueName=#&#123;$valueName&#125;&quot;).append(if (index != valueNameList.size - 1) &quot; and &quot; else &quot;&quot;) &#125;</span><br><span class="line"></span><br><span class="line">        logger.warn(&quot;&quot;&quot;</span><br><span class="line">            ---------------------------------</span><br><span class="line">            mybatis-buildSql-select --&gt;</span><br><span class="line">            tableModel: $tableModel</span><br><span class="line">                   sql: $sqlString</span><br><span class="line">            ---------------------------------</span><br><span class="line">        &quot;&quot;&quot;)</span><br><span class="line">        return sqlString.toString()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import io.swagger.annotations.ApiOperation</span><br><span class="line">import org.springframework.web.bind.annotation.PostMapping</span><br><span class="line">import org.springframework.web.bind.annotation.RequestBody</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping</span><br><span class="line">import org.springframework.web.bind.annotation.RestController</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/ad&quot;)</span><br><span class="line">class AdController(val mapper: AdMapper) &#123;</span><br><span class="line"></span><br><span class="line">    @ApiOperation(&quot;增加&quot;, notes = &quot;返回 ID&quot;)</span><br><span class="line">    @PostMapping(&quot;/insert&quot;)</span><br><span class="line">    fun insert(@RequestBody request: HKRequest&lt;AdModel&gt;): HKResponse&lt;HKIdData&gt; &#123;</span><br><span class="line">        if (request.data == null) return HKCode.ERROR_PARAMS.response()</span><br><span class="line">        return HKResponse(HKIdData(mapper.insert(request.data!!)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @ApiOperation(&quot;删除&quot;, notes = &quot;返回 受影响的行数&quot;)</span><br><span class="line">    @PostMapping(&quot;/delete&quot;)</span><br><span class="line">    fun delete(@RequestBody request: HKRequest&lt;AdModel&gt;): HKResponse&lt;HKColumnData&gt; &#123;</span><br><span class="line">        if (request.data == null) return HKCode.ERROR_PARAMS.response(HKColumnData(-1))</span><br><span class="line">        return HKResponse(HKColumnData(mapper.delete(request.data!!)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @ApiOperation(&quot;修改&quot;, notes = &quot;返回 受影响的行数&quot;)</span><br><span class="line">    @PostMapping(&quot;/update&quot;)</span><br><span class="line">    fun update(@RequestBody request: HKRequest&lt;AdModel&gt;): HKResponse&lt;HKColumnData&gt; &#123;</span><br><span class="line">        if (request.data == null) return HKCode.ERROR_PARAMS.response()</span><br><span class="line">        return HKResponse(HKColumnData(mapper.update(request.data!!)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @ApiOperation(&quot;查询&quot;)</span><br><span class="line">    @PostMapping(&quot;/select&quot;)</span><br><span class="line">    fun select(@RequestBody request: HKRequest&lt;AdModel&gt;): HKResponse&lt;List&lt;AdModel&gt;&gt; &#123;</span><br><span class="line">        if (request.data == null || request.data == null) return HKCode.ERROR_PARAMS.response()</span><br><span class="line">        return HKResponse(mapper.select(request.data!!))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="反射工具类"><a href="#反射工具类" class="headerlink" title="反射工具类"></a>反射工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import java.lang.reflect.Field</span><br><span class="line">import java.lang.reflect.InvocationTargetException</span><br><span class="line">import kotlin.reflect.KClass</span><br><span class="line">import kotlin.reflect.full.companionObject</span><br><span class="line">import kotlin.reflect.full.companionObjectInstance</span><br><span class="line">import kotlin.reflect.full.declaredFunctions</span><br><span class="line"></span><br><span class="line">@Suppress(&quot;unused&quot;)</span><br><span class="line">object HKReflectUtil &#123;</span><br><span class="line">    private val TAG = &quot;[reflect]&quot;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据方法的名字调用方法，适合 object 定义的单例静态方法</span><br><span class="line">     */</span><br><span class="line">    @Throws(RuntimeException::class, IllegalAccessException::class, IllegalArgumentException::class, InvocationTargetException::class, NullPointerException::class, ExceptionInInitializerError::class)</span><br><span class="line">    fun invoke(clazz: KClass&lt;*&gt;?, methodName: String?, vararg params: Any?): Any? &#123;</span><br><span class="line">        if (clazz == null || methodName.isNullOrBlank()) throw RuntimeException(&quot;$&#123;TAG&#125; clazz:$clazz or methodName:$methodName is null&quot;)</span><br><span class="line">        val methods = clazz.java.kotlin.companionObject?.declaredFunctions?.filter &#123; it.name == methodName &amp;&amp; it.parameters.size - 1 == params.size &#125;</span><br><span class="line">        if (methods?.size ?: 0 &lt;= 0) throw RuntimeException(&quot;[callNativeMethod] the invoked method dose not exist :$methodName&quot;)</span><br><span class="line">        return methods!![0].call(clazz.companionObjectInstance, *params)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun getFields(objectClass: Class&lt;*&gt;?): MutableList&lt;Field&gt; &#123;</span><br><span class="line">        var fieldList: MutableList&lt;Field&gt;? = null</span><br><span class="line">        try &#123;</span><br><span class="line">            fieldList = objectClass?.declaredFields?.toMutableList()</span><br><span class="line">            objectClass?.superclass?.declaredFields.let &#123; if (it != null) fieldList?.addAll(it) &#125;</span><br><span class="line">        &#125; catch (ignore: Exception) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        return fieldList ?: arrayListOf()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun getValue(field: Field?, fromObject: Any?): Any? = try &#123;</span><br><span class="line">        field?.isAccessible = true</span><br><span class="line">        field?.get(fromObject)</span><br><span class="line">    &#125; catch (ignore: Exception) &#123;</span><br><span class="line">        null</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h3><p><img src="http://upload-images.jianshu.io/upload_images/2062311-b06f057d9274c144.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="swagger2"></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 服务端 </tag>
            
            <tag> SPRING-BOOT </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安装_CENTOS_FTP</title>
      <link href="/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_FTP/"/>
      <url>/2018/11/19/%E5%AE%89%E8%A3%85_CENTOS_FTP/</url>
      
        <content type="html"><![CDATA[<h3 id="1-安装-vsftpd"><a href="#1-安装-vsftpd" class="headerlink" title="1 安装 vsftpd"></a>1 安装 vsftpd</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 安装vsftpd</span><br><span class="line">yum install -y vsftpd</span><br><span class="line"># 设置开机启动</span><br><span class="line">chkconfig vsftpd on</span><br><span class="line"># 重启</span><br><span class="line">service vsftpd restart</span><br><span class="line"># 查看vsftpd服务的状态</span><br><span class="line">service vsftpd status</span><br></pre></td></tr></table></figure><h3 id="2-配置-vsftpd-conf"><a href="#2-配置-vsftpd-conf" class="headerlink" title="2 配置 vsftpd.conf"></a>2 配置 vsftpd.conf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 备份配置文件</span><br><span class="line">cp /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.bak</span><br><span class="line"># 执行以下命令修改配置文件</span><br><span class="line">sed -i &quot;s/anonymous_enable=YES/anonymous_enable=YES/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#anon_upload_enable=YES/anon_upload_enable=NO/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#anon_mkdir_write_enable=YES/anon_mkdir_write_enable=NO/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#chown_uploads=YES/chown_uploads=NO/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#async_abor_enable=YES/async_abor_enable=YES/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#ascii_upload_enable=YES/ascii_upload_enable=YES/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#ascii_download_enable=YES/ascii_download_enable=YES/g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line">sed -i &quot;s/#ftpd_banner=Welcome to blah FTP service./ftpd_banner=Welcome to FTP service./g&quot; &apos;/etc/vsftpd/vsftpd.conf&apos;</span><br><span class="line"></span><br><span class="line">#添加下列内容到vsftpd.conf末尾</span><br><span class="line">use_localtime=YES</span><br><span class="line">listen_port=21</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">idle_session_timeout=300</span><br><span class="line">guest_enable=YES</span><br><span class="line">guest_username=vsftpd</span><br><span class="line">user_config_dir=/etc/vsftpd/configusers</span><br><span class="line">data_connection_timeout=1</span><br><span class="line">virtual_use_local_privs=YES</span><br><span class="line">pasv_min_port=10060</span><br><span class="line">pasv_max_port=10090</span><br><span class="line">accept_timeout=5</span><br><span class="line">connect_timeout=1</span><br><span class="line"></span><br><span class="line"># 匿名用户相关设置</span><br><span class="line">anon_root=/home/vsftpd/public</span><br><span class="line">local_root=/home/vsftpd/public</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">no_anon_password=YES</span><br><span class="line">anon_upload_enable=NO</span><br><span class="line">anon_mkdir_write_enable=NO</span><br></pre></td></tr></table></figure><h3 id="3-建立用户文件"><a href="#3-建立用户文件" class="headerlink" title="3 建立用户文件"></a>3 建立用户文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 第一行用户名，第二行密码，不能使用root为用户名</span><br><span class="line">vi /etc/vsftpd/virtusers</span><br><span class="line">admin</span><br><span class="line">123456</span><br><span class="line">userA</span><br><span class="line">123456</span><br><span class="line">userB</span><br><span class="line">123456</span><br><span class="line">userC</span><br><span class="line">123456</span><br></pre></td></tr></table></figure><h3 id="4-生成用户数据文件"><a href="#4-生成用户数据文件" class="headerlink" title="4 生成用户数据文件"></a>4 生成用户数据文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 注意如果后面对 /etc/vsftpd/virtusers 用户文件的任意修改比如增加用户, 需要重新执行 db_load 的操作才会生效</span><br><span class="line">db_load -T -t hash -f /etc/vsftpd/virtusers /etc/vsftpd/virtusers.db</span><br><span class="line"># 设定PAM验证文件，并指定对虚拟用户数据库文件进行读取</span><br><span class="line">chmod 600 /etc/vsftpd/virtusers.db</span><br></pre></td></tr></table></figure><h3 id="5-修改-etc-pam-d-vsftpd文件"><a href="#5-修改-etc-pam-d-vsftpd文件" class="headerlink" title="5 修改/etc/pam.d/vsftpd文件"></a>5 修改/etc/pam.d/vsftpd文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 修改前先备份 </span><br><span class="line">cp /etc/pam.d/vsftpd /etc/pam.d/vsftpd.bak</span><br><span class="line"># 将auth及account的所有配置行均注释掉</span><br><span class="line">vi /etc/pam.d/vsftpd</span><br><span class="line">auth sufficient /lib64/security/pam_userdb.so db=/etc/vsftpd/virtusers</span><br><span class="line">account sufficient /lib64/security/pam_userdb.so db=/etc/vsftpd/virtusers</span><br><span class="line"># 如果系统为32位，上面改为lib</span><br></pre></td></tr></table></figure><h3 id="6-新建系统用户vsftpd，用户目录为-home-vsftpd"><a href="#6-新建系统用户vsftpd，用户目录为-home-vsftpd" class="headerlink" title="6 新建系统用户vsftpd，用户目录为/home/vsftpd"></a>6 新建系统用户vsftpd，用户目录为/home/vsftpd</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#用户登录终端设为/bin/false(即：使之不能登录系统)</span><br><span class="line">useradd vsftpd -d /home/vsftpd -s /bin/false</span><br><span class="line">chown -R vsftpd:vsftpd /home/vsftpd</span><br></pre></td></tr></table></figure><h3 id="7-建立虚拟用户个人配置文件"><a href="#7-建立虚拟用户个人配置文件" class="headerlink" title="7 建立虚拟用户个人配置文件"></a>7 建立虚拟用户个人配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/vsftpd/configusers</span><br><span class="line">cd /etc/vsftpd/configusers</span><br><span class="line"></span><br><span class="line">#这里建立两个虚拟用户配合文件</span><br><span class="line">touch admin</span><br><span class="line"></span><br><span class="line">#建立用户根目录</span><br><span class="line">mkdir -p /home/vsftpd/admin/</span><br><span class="line"></span><br><span class="line">#编辑admin用户配置文件，内容如下，其他用户类似</span><br><span class="line">vi admin</span><br><span class="line"></span><br><span class="line">local_root=/home/vsftpd/admin/</span><br><span class="line">write_enable=YES</span><br><span class="line">anon_world_readable_only=NO</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br></pre></td></tr></table></figure><h3 id="8-防火墙设置"><a href="#8-防火墙设置" class="headerlink" title="8 防火墙设置"></a>8 防火墙设置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/iptables-config</span><br><span class="line"># 增加nf_conntrack_ftp， 也有文档ip_conntrack_ftp其实是它的别名</span><br><span class="line">IPTABLES_MODULES=&quot;nf_conntrack_ftp&quot;</span><br><span class="line"></span><br><span class="line"># 保存上面的配置后在控制台执行下面的命令</span><br><span class="line">iptables -A INPUT  -p tcp -m tcp --dport 21 -m conntrack --ctstate ESTABLISHED,NEW -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 21&quot;</span><br><span class="line">iptables -A OUTPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 21&quot;</span><br><span class="line">iptables -A INPUT  -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 20&quot;</span><br><span class="line">iptables -A OUTPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 20&quot;</span><br><span class="line">iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A INPUT -m state --state NEW -p tcp --dport 10060:10090 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -m state --state NEW -p tcp --sport 10060:10090 -j ACCEPT</span><br><span class="line">service iptables save</span><br><span class="line">service iptables restart</span><br><span class="line"></span><br><span class="line"># 如果以上设置不行则尝试进行下面的操作</span><br><span class="line"># 如果以上设置不行则尝试进行下面的操作</span><br><span class="line"># 如果以上设置不行则尝试进行下面的操作</span><br><span class="line"></span><br><span class="line"># 这是替补方案</span><br><span class="line">vi /etc/sysconfig/iptables</span><br><span class="line"># 编辑iptables文件，添加如下内容，开启21端口</span><br><span class="line"></span><br><span class="line"># Generated by iptables-save v1.4.7 on Wed Mar 21 13:50:00 2018</span><br><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 21&quot; -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate RELATED,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 20&quot; -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 10060:10090 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 21&quot; -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED -m comment --comment &quot;Allow ftp connections on port 20&quot; -j ACCEPT</span><br><span class="line">-A OUTPUT -p tcp -m state --state NEW -m tcp --sport 10060:10090 -j ACCEPT</span><br><span class="line">-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">COMMIT</span><br><span class="line"># Completed on Wed Mar 21 13:50:00 2018</span><br><span class="line"></span><br><span class="line"># 重启防火墙使配置生效</span><br><span class="line">service iptables restart</span><br><span class="line"># 或者</span><br><span class="line">/etc/init.d/iptables restart</span><br></pre></td></tr></table></figure><h3 id="9-重启vsftpd服务器"><a href="#9-重启vsftpd服务器" class="headerlink" title="9 重启vsftpd服务器"></a>9 重启vsftpd服务器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service vsftpd restart</span><br></pre></td></tr></table></figure><h3 id="10-连接测试"><a href="#10-连接测试" class="headerlink" title="10 连接测试"></a>10 连接测试</h3><ul><li>在部署 vsftpd 服务的同一台机器上进行内网测试<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install ftp -y</span><br><span class="line">ftp 127.0.0.1</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Connected to 127.0.0.1 (127.0.0.1).</span><br><span class="line">220 Welcome to FTP service.</span><br><span class="line">Name (127.0.0.1:root): admin</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">227 Entering Passive Mode (127,0,0,1,39,88).</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">226 Directory send OK.</span><br><span class="line"></span><br><span class="line"># 至此说明内网可以访问</span><br></pre></td></tr></table></figure><ul><li>在部署 vsftpd 服务的同一台机器上进行外网测试 (查看该服务器外网的ip为 10.10.10.10)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp -p 10.10.10.10</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Connected to 10.10.10.10 (10.10.10.10).</span><br><span class="line">220 Welcome to FTP service.</span><br><span class="line">Name (10.10.10.10:root): admin</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">227 Entering Passive Mode (10,47,12,111,39,77).</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">226 Directory send OK.</span><br><span class="line"></span><br><span class="line"># 至此说明外网可以访问</span><br></pre></td></tr></table></figure><h3 id="11-Connection-refused"><a href="#11-Connection-refused" class="headerlink" title="11 Connection refused"></a>11 Connection refused</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 查看 21 端口是否已开启</span><br><span class="line">netstat -na --ip</span><br><span class="line"></span><br><span class="line"># 在客户端测试</span><br><span class="line">$ telnet ip.ip.ip.ip 21</span><br><span class="line">Trying ip.ip.ip.ip...</span><br><span class="line">telnet: connect to address ip.ip.ip.ip: Connection refused</span><br><span class="line">telnet: Unable to connect to remote host</span><br><span class="line"></span><br><span class="line"># 发现在客户端连接不上,尝试关闭 vsftpd 服务器的防火墙</span><br><span class="line">service vsftpd stop</span><br><span class="line"></span><br><span class="line"># 在客户端重新 telnet</span><br><span class="line">telnet  ip.ip.ip.ip 21</span><br><span class="line">Trying ip.ip.ip.ip...</span><br><span class="line">Connected to v600000-97.dds.com.</span><br><span class="line">Escape character is &apos;^]&apos;.</span><br><span class="line">220 Welcome to FTP service.</span><br><span class="line"></span><br><span class="line"># 发现连接成功,则问题出在防火墙的配置上</span><br><span class="line"># 可以尝试把防火墙设置为 第8步的一模一样(注意备份)再试试</span><br></pre></td></tr></table></figure><h1 id="目录结构与成员权限配置"><a href="#目录结构与成员权限配置" class="headerlink" title="目录结构与成员权限配置"></a>目录结构与成员权限配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 假设有以下目录结构</span><br><span class="line">/home/vsftpd/</span><br><span class="line">.</span><br><span class="line">└── resources</span><br><span class="line">    └── organization</span><br><span class="line">        └── abc</span><br><span class="line">            └── apps</span><br><span class="line">                └── xyz</span><br><span class="line">                    └── 4.5.1</span><br><span class="line">                        ├── debug</span><br><span class="line">                        │   ├── android</span><br><span class="line">                        │   └── ios</span><br><span class="line">                        └── release</span><br><span class="line">                            ├── android</span><br><span class="line">                            └── ios</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/vsftpd/vsftpd.conf</span><br><span class="line"># 设置匿名用户只能访问 apps 目录</span><br><span class="line">anon_root=/home/vsftpd/resources/organization/abc/apps</span><br><span class="line"># 设置登录用户的默认访问目录 为abc, 权限比匿名用户高一级</span><br><span class="line">local_root=/home/vsftpd/resources/organization/abc</span><br><span class="line"></span><br><span class="line">#保存 重启 vsftpd</span><br><span class="line">service vsftpd restart</span><br></pre></td></tr></table></figure><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><ul><li>发现有的用户可以登录, 但是有的用户报出 <strong>‘Server response: ‘530 Login incorrect.’ ‘</strong> 错误<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 原因是由于在 /etc/vsftpd/virtusers 中增加/修改/删除了用户, 需要重新执行以下命令, 问题解决</span><br><span class="line">db_load -T -t hash -f /etc/vsftpd/virtusers /etc/vsftpd/virtusers.db</span><br><span class="line">service vsftpd restart</span><br><span class="line"></span><br><span class="line"># 即对 /etc/vsftpd/virtusers 用户文件的任意修改, 需要重新执行 db_load 的操作才会生效</span><br></pre></td></tr></table></figure></li></ul><h1 id="所以正确的新增-修改用户的步骤为"><a href="#所以正确的新增-修改用户的步骤为" class="headerlink" title="所以正确的新增/修改用户的步骤为"></a>所以正确的新增/修改用户的步骤为</h1><ol><li>在 /etc/vsftpd/virtusers 文件中增加用户名密码</li><li>在 /etc/vsftpd/configusers 中新建该用户对应的配置文件</li><li>执行命令刷新数据库<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_load -T -t hash -f /etc/vsftpd/virtusers /etc/vsftpd/virtusers.db</span><br></pre></td></tr></table></figure></li></ol><h1 id="上传文件失败-‘Server-response-‘200-PORT-command-successful-Consider-using-PASV-’’"><a href="#上传文件失败-‘Server-response-‘200-PORT-command-successful-Consider-using-PASV-’’" class="headerlink" title="上传文件失败 ‘Server response: ‘200 PORT command successful. Consider using PASV.’’"></a>上传文件失败 <strong>‘Server response: ‘200 PORT command successful. Consider using PASV.’’</strong></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将 /home/vsftpd 本身及其所有子目录子文件的权限和组都改为 vsftpd 用户, 普通用户才会有权限上传文件</span><br><span class="line">chown -R vsftpd:vsftpd /home/vsftpd</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls -l</span><br><span class="line">total 8</span><br><span class="line">drwxr-xr-x. 2 vsftpd vsftpd 4096 Mar 21 19:19 android</span><br><span class="line">drwxr-xr-x. 2 vsftpd vsftpd 4096 Mar 21 16:22 ios</span><br></pre></td></tr></table></figure><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul><li><a href="http://blog.csdn.net/the_victory/article/details/52192085" target="_blank" rel="noopener">http://blog.csdn.net/the_victory/article/details/52192085</a></li><li><a href="https://www.cnblogs.com/changbin/p/5830395.html" target="_blank" rel="noopener">https://www.cnblogs.com/changbin/p/5830395.html</a></li><li><a href="https://jingyan.baidu.com/article/ea24bc3984a3b2da63b33154.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/ea24bc3984a3b2da63b33154.html</a></li><li><a href="https://unix.stackexchange.com/questions/93554/iptables-to-allow-incoming-ftp" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/93554/iptables-to-allow-incoming-ftp</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安装 </tag>
            
            <tag> CENTOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>移动端_IOS_UICOLLECTIONVIEW_CELL_自适应大小</title>
      <link href="/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_UICOLLECTIONVIEW_CELL_%E8%87%AA%E9%80%82%E5%BA%94%E5%A4%A7%E5%B0%8F/"/>
      <url>/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_UICOLLECTIONVIEW_CELL_%E8%87%AA%E9%80%82%E5%BA%94%E5%A4%A7%E5%B0%8F/</url>
      
        <content type="html"><![CDATA[<h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p>自己研究是一个痛苦的过程,网上的完整一点的文章很少,而且总是遇到各种各样的问题,所以记录下来去帮助那些像我一样的人少走一些弯路</p><h3 id="实现目标-可以横向滚动的菜单栏"><a href="#实现目标-可以横向滚动的菜单栏" class="headerlink" title="实现目标 可以横向滚动的菜单栏"></a>实现目标 可以横向滚动的菜单栏</h3><p>点击任意一个CELL ,下方的数据发生改变,这里先用横向滚动的UITableView,不好做,然后用第三方的UIScrollView做的,也不好用</p><p><img src="http://upload-images.jianshu.io/upload_images/2062311-65e0a7b6423957be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">一个小小的自适应代码,搞了两天两夜,IOS相比Android编码,简直太落后了,</span><br><span class="line"></span><br><span class="line">1. 通过约束自适应大小会出现最后1-2个数据不显示的问题,count是正确的,此时发现设置sectionInset&gt;0 以及 minimumLineSpacing=1 就显示完整了,但是这样代码就变成了魔术代码,后经过多方请教,发现决定性因素是 返回 CELL size的时候不能写 zero, 宽度自适应的时候,设置宽&gt;0,高度自适应的时候要设置高&gt;0,不然会出现末尾的几个cell丢失的不明不白的问题,如果约束写在自定义CELL 的 layoutSubviews 方法里,则需要在显示CELL的时候即cellForItemAt方法里调用 cell.layoutIfNeeded(),不然会出现CELL错乱的问题</span><br><span class="line"></span><br><span class="line">2. 通过自己计算CELL的大小,最开始是稀里糊涂的,结果现在已经豁然开朗,在 sizeForItemAt 里面返回的是 CELL.frame 的size ,但是CELL frame 里面的子view 都还没有设置大小,所以会不显示,需要在 layoutSubviews 里对子view进行设置大小,所以我认为 layoutSubviews 方法是在 sizeForItemAt之后调用的,已经可以拿到 CELL frame size</span><br><span class="line"></span><br><span class="line">3. 总结: 约束自适应优先使用,因为CELL越来越复杂的话自己计算就会十分麻烦,当然也可以自己计算大小然后通过约束来搞定subView 之间的位置关系混着用</span><br></pre></td></tr></table></figure><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">import SnapKit</span><br><span class="line">import Foundation</span><br><span class="line"></span><br><span class="line">class HorizontalCollectionView: UIView, UICollectionViewDelegate, UICollectionViewDataSource, UICollectionViewDelegateFlowLayout &#123;</span><br><span class="line">    var dataArray: [String] = [] &#123;</span><br><span class="line">        didSet &#123;</span><br><span class="line">            collectionView.reloadData()</span><br><span class="line">            collectionView.collectionViewLayout.invalidateLayout()</span><br><span class="line">            //collectionView.reloadSections(IndexSet(integersIn: 0...0))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var collectionView: UICollectionView!</span><br><span class="line"></span><br><span class="line">    override init(frame: CGRect) &#123;</span><br><span class="line">        super.init(frame: frame)</span><br><span class="line">        self.setUp()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    required init?(coder aDecoder: NSCoder) &#123;</span><br><span class="line">        fatalError(&quot;init(coder:) has not been implemented&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func requestViewData() &#123;</span><br><span class="line">        dataArray = [&quot;0&quot;, &quot;1&quot;, &quot;22&quot;, &quot;333&quot;, &quot;4444&quot;, &quot;55555&quot;, &quot;666666&quot;, &quot;7777777&quot;, &quot;88888888&quot;, &quot;999999999&quot;, &quot;10101010101010101010&quot;, &quot;A&quot;, &quot;1111111111111111111111&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;]</span><br><span class="line">        print(&quot;dataArray.count=&quot;, dataArray.count)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private func setUp() &#123;</span><br><span class="line">        let flowLayout = UICollectionViewFlowLayout()</span><br><span class="line"></span><br><span class="line">        flowLayout.minimumInteritemSpacing = 10;</span><br><span class="line">        flowLayout.sectionInset = UIEdgeInsetsMake(0, 0, 0, 0)</span><br><span class="line">        flowLayout.scrollDirection = .horizontal</span><br><span class="line"></span><br><span class="line">        //===== CELL 约束自适应 必备条件 1 =====</span><br><span class="line">        if #available(iOS 10.0, *) &#123;</span><br><span class="line">            flowLayout.estimatedItemSize = UICollectionViewFlowLayoutAutomaticSize</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            flowLayout.estimatedItemSize = CGSize(width: 15, height: 48)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        collectionView = UICollectionView.init(frame: CGRect(0, 0, SCREEN_WIDTH, 48), collectionViewLayout: flowLayout)</span><br><span class="line">        collectionView.delegate = self</span><br><span class="line">        collectionView.dataSource = self</span><br><span class="line">        collectionView.backgroundColor = UIColor.yellow</span><br><span class="line">        collectionView.showsHorizontalScrollIndicator = false</span><br><span class="line">        self.addSubview(collectionView)</span><br><span class="line"></span><br><span class="line">        collectionView.register(HorizontalLabelCell.classForCoder(), forCellWithReuseIdentifier: &quot;_cell&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) &#123;</span><br><span class="line">        print(&quot;点击了 cell&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int &#123;</span><br><span class="line">        print(&quot;dataArray.count=&quot;, dataArray.count)</span><br><span class="line">        return dataArray.count</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell &#123;</span><br><span class="line">        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: &quot;_cell&quot;, for: indexPath) as! HorizontalLabelCell</span><br><span class="line">        cell.title = dataArray[indexPath.row]</span><br><span class="line">        return cell</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -&gt; CGSize &#123;</span><br><span class="line">        //===== CELL 计算自适应 必备条件 1 =====</span><br><span class="line">        // return CGSize(dataArray[indexPath.row].widthWithFont(), 48)</span><br><span class="line"></span><br><span class="line">        //===== CELL 约束自适应 必备条件 2 ===== 宽度或者高度一定要  大于 0 ,否则会出现丢失错误等不可预料问题</span><br><span class="line">        return CGSize(0.01, 48)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HorizontalLabelCell: UICollectionViewCell &#123;</span><br><span class="line"></span><br><span class="line">    private lazy var titleLabel: UILabel = &#123;</span><br><span class="line">        let label = UILabel()</span><br><span class="line">        label.numberOfLines = 1</span><br><span class="line">        label.font = UIFont.systemFont(ofSize: 18)</span><br><span class="line">        label.textAlignment = .center</span><br><span class="line">        label.textColor = UIColor.red</span><br><span class="line">        return label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    var title: String = &quot;&quot; &#123;</span><br><span class="line">        didSet &#123;</span><br><span class="line">            self.titleLabel.text = title</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    required init?(coder aDecoder: NSCoder) &#123;</span><br><span class="line">        super.init(coder: aDecoder)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override init(frame: CGRect) &#123;</span><br><span class="line">        super.init(frame: frame)</span><br><span class="line">        self.contentView.addSubview(self.titleLabel)</span><br><span class="line"></span><br><span class="line">        //===== CELL 约束自适应 必备条件 3 =====</span><br><span class="line">        self.titleLabel.snp.makeConstraints &#123; maker in</span><br><span class="line">            maker.left.top.equalTo(self.contentView)</span><br><span class="line">            maker.width.greaterThanOrEqualTo(5)</span><br><span class="line">            maker.height.greaterThanOrEqualTo(48)</span><br><span class="line">            maker.height.equalTo(self.contentView).priorityLow()</span><br><span class="line">            maker.right.equalTo(self.contentView).priorityLow()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //===== CELL 计算自适应 必备条件 2 ===== 如果没有使用约束,则在这里赋值 subViews frame 大小</span><br><span class="line">    /*override func layoutSubviews() &#123;</span><br><span class="line">        super.layoutSubviews()</span><br><span class="line">        self.titleLabel.frame = self.contentView.frame</span><br><span class="line">    &#125;*/</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">lazy var topMenuView: HorizontalCollectionView = &#123;</span><br><span class="line">    let horizontalView = HorizontalCollectionView.init(frame: CGRect(0, 0, SCREEN_WIDTH, 48))</span><br><span class="line">    return horizontalView</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">override func viewDidLoad() &#123;</span><br><span class="line">    self.view.addSubview(self.topMenuView)</span><br><span class="line">    self.topMenuView.snp.makeConstraints &#123; maker in</span><br><span class="line">        maker.left.right.top.equalTo(self.view)</span><br><span class="line">        maker.height.equalTo(48)</span><br><span class="line">    &#125;</span><br><span class="line">    self.topMenuView.requestViewData()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><p>经过多次使用总结: 上面通过约束自适应的方案当只有一个 cell 的时候,会居中,需要自定义 followLayout 设置左对齐,总之会有各种各样的问题,经老开发提醒,UICollectionView 的宽高最好在 外部给定, 即 sizeForItemAtIndexPath 这里返回固定的宽高,然后 不要设置 estimatedItemSize,然后在 自定义Cell里面通过约束布局,<br>注意 UICollectionView 有默认的 spacing 间距,需要设置为0,才不会出现计算之外的问题,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UICollectionViewFlowLayout *layout = [UICollectionViewFlowLayout new];</span><br><span class="line">layout.minimumInteritemSpacing = 0;</span><br><span class="line">layout.minimumLineSpacing = 0;</span><br></pre></td></tr></table></figure></p><p>即趋势应该是  由外到内 的设置 大小.</p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 移动端 </tag>
            
            <tag> IOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>移动端_IOS_发布</title>
      <link href="/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_%E5%8F%91%E5%B8%83/"/>
      <url>/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_%E5%8F%91%E5%B8%83/</url>
      
        <content type="html"><![CDATA[<h3 id="1-首先设置-apple-开发者账号"><a href="#1-首先设置-apple-开发者账号" class="headerlink" title="1: 首先设置 apple 开发者账号"></a>1: 首先设置 apple <a href="https://developer.apple.com/account/ios/identifier/bundle]" target="_blank" rel="noopener">开发者账号</a></h3><p>我把所有的(Certificates/Provisioning Profiles)全部删除了,只留下 Identifiers 菜单里面的 App IDs 里面的  该应用的 id</p><p><img src="http://upload-images.jianshu.io/upload_images/2062311-b2e1aa094039036c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><h3 id="2-xcode-登录账号密码"><a href="#2-xcode-登录账号密码" class="headerlink" title="2: xcode 登录账号密码"></a>2: xcode 登录账号密码</h3><h3 id="3-Targets-gt-General-gt-Identity-gt-Bundle-Identifier-输入-与步骤一里面-app-id-对应的-id"><a href="#3-Targets-gt-General-gt-Identity-gt-Bundle-Identifier-输入-与步骤一里面-app-id-对应的-id" class="headerlink" title="3: Targets -&gt; General -&gt; Identity -&gt; Bundle Identifier  输入 与步骤一里面 app id 对应的 id"></a>3: Targets -&gt; General -&gt; Identity -&gt; Bundle Identifier  输入 与步骤一里面 app id 对应的 id</h3><h3 id="3-Targets-gt-General-gt-Signing-gt-Team-选择注册-该应用-Bundle-Identifier-的账号-这里很关键"><a href="#3-Targets-gt-General-gt-Signing-gt-Team-选择注册-该应用-Bundle-Identifier-的账号-这里很关键" class="headerlink" title="3: Targets -&gt; General -&gt; Signing -&gt; Team 选择注册 该应用 Bundle Identifier 的账号 (这里很关键)"></a>3: Targets -&gt; General -&gt; Signing -&gt; Team 选择注册 该应用 Bundle Identifier 的账号 (这里很关键)</h3><ul><li>一般个人账号没有注册 Bundle Identifier (Personal Team 都是为了自己免费在自己的真机上测试使用的)</li><li>如果选择了注册 该应用 的 Bundle Identifier 的账号,则 步骤二必须 填写相同的 Bundle Identifier,生成的包应该即可以发布到appstore,也可以发给注册了 iphone-uuid 的用户安装测试</li><li>如果选择了个人账号(Personal Team ),则必须填写与 appstore中完全不重复的 Bundle Identifier(随便写一个)才能编译通过,而且生成的包不能发布到 app store, 但是应该依然可以发给注册了 iphone-uuid 的用户安装使用<h3 id="4-Targets-gt-Build-Settings-gt-Code-Signing-Identity-gt-选择步骤3里面的-Signing-Certificate-相同账号的账号"><a href="#4-Targets-gt-Build-Settings-gt-Code-Signing-Identity-gt-选择步骤3里面的-Signing-Certificate-相同账号的账号" class="headerlink" title="4: Targets -&gt; Build Settings -&gt; Code Signing Identity -&gt; 选择步骤3里面的 Signing Certificate 相同账号的账号"></a>4: Targets -&gt; Build Settings -&gt; Code Signing Identity -&gt; 选择步骤3里面的 Signing Certificate 相同账号的账号</h3><h3 id="5-Xcode-gt-Product-gt-Archive-进行打包"><a href="#5-Xcode-gt-Product-gt-Archive-进行打包" class="headerlink" title="5: Xcode -&gt; Product -&gt; Archive 进行打包"></a>5: Xcode -&gt; Product -&gt; Archive 进行打包</h3></li><li>如果个人/公司账号想要发布到 蒲公英等,打包成功后选择 AD HOC<br><img src="http://upload-images.jianshu.io/upload_images/2062311-d539bd819e46c5b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="发布 ad hoc.png"></li><li>如果想发布到 app store 则直接点击 upload to appstore<br><img src="http://upload-images.jianshu.io/upload_images/2062311-b4bd45902c958451.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="发布.png"></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 移动端 </tag>
            
            <tag> IOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>移动端_IOS_文件操作</title>
      <link href="/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
      <url>/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_IOS_%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h5 id="1：-拖拽需要打包的文件至工程为蓝色，勾选-Copy-items-if-needed-and-Create-folder-references"><a href="#1：-拖拽需要打包的文件至工程为蓝色，勾选-Copy-items-if-needed-and-Create-folder-references" class="headerlink" title="1： 拖拽需要打包的文件至工程为蓝色，勾选 Copy items if needed and Create folder references"></a>1： 拖拽需要打包的文件至工程为蓝色，勾选 Copy items if needed and Create folder references</h5><h5 id="2：TARGETS-gt-Build-Phases-gt-Copy-Bundle-Resources-gt-add-第一步的文件"><a href="#2：TARGETS-gt-Build-Phases-gt-Copy-Bundle-Resources-gt-add-第一步的文件" class="headerlink" title="2：TARGETS -&gt; Build Phases -&gt; Copy Bundle Resources -&gt; add 第一步的文件"></a>2：TARGETS -&gt; Build Phases -&gt; Copy Bundle Resources -&gt; add 第一步的文件</h5><h5 id="3：案例"><a href="#3：案例" class="headerlink" title="3：案例"></a>3：案例</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">// 1、获取沙盒根目录let homeDir = NSHomeDirectory() as String</span><br><span class="line">let homeDir = NSHomeDirectory() as String</span><br><span class="line">print(&quot;[hybird]&quot;, &quot;homeDir&quot;, homeDir)</span><br><span class="line"></span><br><span class="line">// 2、获取 Documents 目录</span><br><span class="line">let docDirs = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true) as NSArray</span><br><span class="line">let docDir = docDirs[0] as! String</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;docDirs&quot;,docDirs)</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;docDir&quot;,docDir)</span><br><span class="line">// 3、获取 Caches 目录</span><br><span class="line">let cachesDirs = NSSearchPathForDirectoriesInDomains(.cachesDirectory, .userDomainMask, true) as NSArray</span><br><span class="line">let cachesDir = cachesDirs[0] as! String</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;cachesDirs&quot;,cachesDirs)</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;cachesDir&quot;,cachesDir)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 4、获取 Library 目录</span><br><span class="line">let libDirs = NSSearchPathForDirectoriesInDomains(.libraryDirectory, .userDomainMask, true) as NSArray</span><br><span class="line">let libDir = libDirs[0] as! String</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;libDirs&quot;,libDirs)</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;libDir&quot;,libDir)</span><br><span class="line"></span><br><span class="line">// 5、获取 tmp 目录</span><br><span class="line"></span><br><span class="line">let tmpDir = NSTemporaryDirectory() as String</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;tmpDir&quot;,tmpDir)</span><br><span class="line"></span><br><span class="line">// 6、初始化 fileManager</span><br><span class="line">let fileManager = FileManager.default</span><br><span class="line"></span><br><span class="line">// 7、使用 fileManager 创建目录</span><br><span class="line">let testDir = docDir + &quot;/test&quot;</span><br><span class="line"></span><br><span class="line">do &#123;</span><br><span class="line">    try  fileManager.createDirectory(atPath: testDir, withIntermediateDirectories: true, attributes: nil)</span><br><span class="line">&#125; catch &#123;</span><br><span class="line">    print(&quot;[hybird]&quot;,&quot;createDirectory failure&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 8、使用 fileManager 创建文件</span><br><span class="line">let testFile1 = testDir + &quot;/test1.txt&quot;</span><br><span class="line">let testFile2 = testDir + &quot;/test2.txt&quot;</span><br><span class="line">fileManager.createFile(atPath: testFile1, contents: nil, attributes: nil)</span><br><span class="line">fileManager.createFile(atPath: testFile2, contents: nil, attributes: nil)</span><br><span class="line"></span><br><span class="line">// 9、使用 fileManager 获取目录下的文件名</span><br><span class="line">var files = fileManager.subpaths(atPath: testDir)</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;files:&quot;,files ?? &quot;&quot;)</span><br><span class="line">// 10、使用 fileManager 删除文件</span><br><span class="line">do &#123;</span><br><span class="line">    try fileManager.removeItem(atPath: testFile1)</span><br><span class="line">&#125; catch  &#123;</span><br><span class="line">    print(&quot;[hybird]&quot;,&quot;removeItem failure&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(&quot;[hybird]&quot;,&quot;Bundle.main.resourcePath&quot;,Bundle.main.resourcePath ?? &quot;null&quot;)</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;Bundle.main.bundlePath&quot;,Bundle.main.bundlePath)</span><br><span class="line"></span><br><span class="line">files = fileManager.subpaths(atPath: Bundle.main.bundlePath)</span><br><span class="line"></span><br><span class="line">print(&quot;[hybird]&quot;,&quot;============================================&quot;)</span><br><span class="line">for file in files! &#123;</span><br><span class="line">    print(&quot;[hybird]&quot;,&quot;file:&quot;,file)</span><br><span class="line">&#125;</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;============================================&quot;)</span><br><span class="line"></span><br><span class="line">let bundleZipPath = Bundle.main.path(forResource: &quot;bundle&quot;, ofType: &quot;zip&quot;, inDirectory: &quot;assets&quot;) ?? &quot;&quot;</span><br><span class="line">print(&quot;[hybird]&quot;,&quot;bundleZipPath:&quot;,bundleZipPath)</span><br></pre></td></tr></table></figure><h5 id="4：输出"><a href="#4：输出" class="headerlink" title="4：输出"></a>4：输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[hybird] homeDir /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630</span><br><span class="line">[hybird] docDirs (</span><br><span class="line">    &quot;/Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Documents&quot;</span><br><span class="line">)</span><br><span class="line">[hybird] docDir /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Documents</span><br><span class="line">[hybird] cachesDirs (</span><br><span class="line">    &quot;/Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Library/Caches&quot;</span><br><span class="line">)</span><br><span class="line">[hybird] cachesDir /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Library/Caches</span><br><span class="line">[hybird] libDirs (</span><br><span class="line">    &quot;/Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Library&quot;</span><br><span class="line">)</span><br><span class="line">[hybird] libDir /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/Library</span><br><span class="line">[hybird] tmpDir /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Data/Application/26A9A63E-FB26-4975-B2C9-CD71B0ECE630/tmp/</span><br><span class="line">[hybird] files: [&quot;test1.txt&quot;, &quot;test2.txt&quot;]</span><br><span class="line">[hybird] Bundle.main.resourcePath /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Bundle/Application/A4E96998-21EA-4EFB-9B13-B4FDBC16D9F0/fruit-shop-ios.app</span><br><span class="line">[hybird] Bundle.main.bundlePath /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Bundle/Application/A4E96998-21EA-4EFB-9B13-B4FDBC16D9F0/fruit-shop-ios.app</span><br><span class="line">[hybird] ============================================</span><br><span class="line">[hybird] file: _CodeSignature</span><br><span class="line">[hybird] file: _CodeSignature/CodeResources</span><br><span class="line">[hybird] file: assets</span><br><span class="line">[hybird] file: assets/bundle.zip</span><br><span class="line">[hybird] file: Assets.car</span><br><span class="line">[hybird] file: Base.lproj</span><br><span class="line">[hybird] file: Base.lproj/LaunchScreen.storyboardc</span><br><span class="line">[hybird] file: Base.lproj/LaunchScreen.storyboardc/01J-lp-oVM-view-Ze5-6b-2t3.nib</span><br><span class="line">[hybird] file: Base.lproj/LaunchScreen.storyboardc/Info.plist</span><br><span class="line">[hybird] file: Base.lproj/LaunchScreen.storyboardc/UIViewController-01J-lp-oVM.nib</span><br><span class="line">[hybird] file: Base.lproj/Main.storyboardc</span><br><span class="line">[hybird] file: Base.lproj/Main.storyboardc/BYZ-38-t0r-view-8bC-Xf-vdC.nib</span><br><span class="line">[hybird] file: Base.lproj/Main.storyboardc/Info.plist</span><br><span class="line">[hybird] file: Base.lproj/Main.storyboardc/UIViewController-BYZ-38-t0r.nib</span><br><span class="line">[hybird] file: Frameworks</span><br><span class="line">[hybird] file: Frameworks/libswiftCore.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftCoreFoundation.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftCoreGraphics.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftCoreImage.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftDarwin.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftDispatch.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftFoundation.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftMetal.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftObjectiveC.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftos.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftQuartzCore.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftSwiftOnoneSupport.dylib</span><br><span class="line">[hybird] file: Frameworks/libswiftUIKit.dylib</span><br><span class="line">[hybird] file: Frameworks/SnapKit.framework</span><br><span class="line">[hybird] file: Frameworks/SnapKit.framework/_CodeSignature</span><br><span class="line">[hybird] file: Frameworks/SnapKit.framework/_CodeSignature/CodeResources</span><br><span class="line">[hybird] file: Frameworks/SnapKit.framework/Info.plist</span><br><span class="line">[hybird] file: Frameworks/SnapKit.framework/SnapKit</span><br><span class="line">[hybird] file: fruit-shop-ios</span><br><span class="line">[hybird] file: Info.plist</span><br><span class="line">[hybird] file: libswiftRemoteMirror.dylib</span><br><span class="line">[hybird] file: PkgInfo</span><br><span class="line">[hybird] file: Podfile</span><br><span class="line">[hybird] ============================================</span><br><span class="line">[hybird] bundleZipPath: /Users/maokangren/Library/Developer/CoreSimulator/Devices/4001EB70-F821-4801-905D-49DA2DAF52C2/data/Containers/Bundle/Application/A4E96998-21EA-4EFB-9B13-B4FDBC16D9F0/fruit-shop-ios.app/assets/bundle.zip</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 移动端 </tag>
            
            <tag> IOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>移动端_REACT_NATIVE_拆分BUNDLE与ANDROID加载</title>
      <link href="/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_REACT_NATIVE_%E6%8B%86%E5%88%86BUNDLE%E4%B8%8EANDROID%E5%8A%A0%E8%BD%BD/"/>
      <url>/2018/11/19/%E7%A7%BB%E5%8A%A8%E7%AB%AF_REACT_NATIVE_%E6%8B%86%E5%88%86BUNDLE%E4%B8%8EANDROID%E5%8A%A0%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h3 id="1-拆分-bundle-代码-基于-react-native-最新版本-0-55-4-https-github-com-krmao-smart-metro-tree-smart"><a href="#1-拆分-bundle-代码-基于-react-native-最新版本-0-55-4-https-github-com-krmao-smart-metro-tree-smart" class="headerlink" title="1 拆分 bundle 代码(基于 react native 最新版本 0.55.4)https://github.com/krmao/smart-metro/tree/smart"></a>1 拆分 bundle 代码(基于 react native 最新版本 0.55.4)<a href="https://github.com/krmao/smart-metro/tree/smart" target="_blank" rel="noopener">https://github.com/krmao/smart-metro/tree/smart</a></h3><h3 id="2-android-分步加载-react-native-bundle-代码https-github-com-krmao-template-tree-reactnative-apps-app-template-android-arsenal-modules-module-template-react-native-src-main-java-com-smart-template-module-rn"><a href="#2-android-分步加载-react-native-bundle-代码https-github-com-krmao-template-tree-reactnative-apps-app-template-android-arsenal-modules-module-template-react-native-src-main-java-com-smart-template-module-rn" class="headerlink" title="2 android 分步加载 react native bundle 代码https://github.com/krmao/template/tree/reactnative/apps/app-template/android/arsenal/modules/module-template-react_native/src/main/java/com/smart/template/module/rn"></a>2 android 分步加载 react native bundle 代码<a href="https://github.com/krmao/template/tree/reactnative/apps/app-template/android/arsenal/modules/module-template-react_native/src/main/java/com/smart/template/module/rn" target="_blank" rel="noopener">https://github.com/krmao/template/tree/reactnative/apps/app-template/android/arsenal/modules/module-template-react_native/src/main/java/com/smart/template/module/rn</a></h3><h3 id="参考-https-github-com-tsyeyuanfeng-metro-bundler"><a href="#参考-https-github-com-tsyeyuanfeng-metro-bundler" class="headerlink" title="参考 https://github.com/tsyeyuanfeng/metro-bundler"></a>参考 <a href="https://github.com/tsyeyuanfeng/metro-bundler" target="_blank" rel="noopener">https://github.com/tsyeyuanfeng/metro-bundler</a></h3>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 移动端 </tag>
            
            <tag> REACT-NATIVE </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>算法_00000_通用工具类</title>
      <link href="/2018/11/19/%E7%AE%97%E6%B3%95_00000_%E9%80%9A%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/"/>
      <url>/2018/11/19/%E7%AE%97%E6%B3%95_00000_%E9%80%9A%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<h3 id="本文包含后面所有算法中涉及到的工具类"><a href="#本文包含后面所有算法中涉及到的工具类" class="headerlink" title="本文包含后面所有算法中涉及到的工具类"></a>本文包含后面所有算法中涉及到的工具类</h3><h3 id="Vocabulary"><a href="#Vocabulary" class="headerlink" title="Vocabulary"></a>Vocabulary</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.common;</span><br><span class="line"></span><br><span class="line">public class Vocabulary &#123;</span><br><span class="line">    public static char charAt(int index) &#123;</span><br><span class="line">        return (char) (index + 65);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int indexFrom(char _char) &#123;</span><br><span class="line">        return _char - 65;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MatrixUtil"><a href="#MatrixUtil" class="headerlink" title="MatrixUtil"></a>MatrixUtil</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.common;</span><br><span class="line"></span><br><span class="line">public class MatrixUtil &#123;</span><br><span class="line">    public static final int INF = -1;//无穷大/不可达</span><br><span class="line"></span><br><span class="line">    public static void printMatrix(final int[][] originalMatrix) &#123;</span><br><span class="line">        if (originalMatrix != null) &#123;</span><br><span class="line">            System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">            System.out.printf(&quot;%3c%3c&quot;, &apos; &apos;, &apos;┃&apos;);</span><br><span class="line">            for (int i = 0; i &lt; originalMatrix.length; i++)</span><br><span class="line">                System.out.printf(&quot;%6c&quot;, Vocabulary.charAt(i));</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">            ;</span><br><span class="line">            for (int i = 0; i &lt; originalMatrix.length; i++) &#123;</span><br><span class="line">                int[] itemMatrix = originalMatrix[i];</span><br><span class="line">                System.out.printf(&quot;%3c%3c&quot;, Vocabulary.charAt(i), &apos;┃&apos;);</span><br><span class="line">                for (int itemValue : itemMatrix)</span><br><span class="line">                    if (itemValue == INF)</span><br><span class="line">                        System.out.printf(&quot;%6s&quot;, &quot;INF&quot;);</span><br><span class="line">                    else</span><br><span class="line">                        System.out.printf(&quot;%6d&quot;, itemValue);</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>算法_00001_Floyed</title>
      <link href="/2018/11/19/%E7%AE%97%E6%B3%95_00001_Floyed/"/>
      <url>/2018/11/19/%E7%AE%97%E6%B3%95_00001_Floyed/</url>
      
        <content type="html"><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul><li>利用动态规划的思想寻找给定的加权图中多源点之间最短路径的算法</li></ul><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ul><li>遍历所有地点(一层循环),判断该地点是否可以让 <strong>任意两地(这里就需要另外两层循环)</strong> 的距离更近,如果可以,记录下这个更短的距离,顺便保存路径</li><li>保存路径则按照保存第三地点名称的思路,假如AB之间有C使之更近,则PATH[A][B]=C;而其它循环自然会处理PATH[A][C],PATH[C][B]的问题,<strong>==INF</strong>则表示再无第三地点使之更近</li><li>输出路径则按照递归的思想,直到两个地点之间再无第三地点使之更近,递归结束</li></ul><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p><img src="http://upload-images.jianshu.io/upload_images/2062311-7dcfdf27226f5f4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="邻接矩阵.png"></p><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p>结果如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">初始化原始点到点距离矩阵:</span><br><span class="line">--------------------------------------------------</span><br><span class="line">     0     2     6     4</span><br><span class="line">    -1     0     3    -1</span><br><span class="line">     7    -1     0     1</span><br><span class="line">     5    -1    12     0</span><br><span class="line">--------------------------------------------------</span><br><span class="line">经过 Floyed 算法处理之后的点到点最短距离矩阵:</span><br><span class="line">--------------------------------------------------</span><br><span class="line">     0     2     5     4</span><br><span class="line">     9     0     3     4</span><br><span class="line">     6     8     0     1</span><br><span class="line">     5     7    10     0</span><br><span class="line">--------------------------------------------------</span><br><span class="line">[0-&gt;0] 的最短路径为 :(0-&gt;0)</span><br><span class="line">[0-&gt;1] 的最短路径为 :(0-&gt;1)</span><br><span class="line">[0-&gt;2] 的最短路径为 :(0-&gt;1-&gt;2)</span><br><span class="line">[0-&gt;3] 的最短路径为 :(0-&gt;3)</span><br><span class="line">[1-&gt;0] 的最短路径为 :(1-&gt;2-&gt;0)</span><br><span class="line">[1-&gt;1] 的最短路径为 :(1-&gt;1)</span><br><span class="line">[1-&gt;2] 的最短路径为 :(1-&gt;2)</span><br><span class="line">[1-&gt;3] 的最短路径为 :(1-&gt;2-&gt;3)</span><br><span class="line">[2-&gt;0] 的最短路径为 :(2-&gt;3-&gt;0)</span><br><span class="line">[2-&gt;1] 的最短路径为 :(2-&gt;3-&gt;0-&gt;1)</span><br><span class="line">[2-&gt;2] 的最短路径为 :(2-&gt;2)</span><br><span class="line">[2-&gt;3] 的最短路径为 :(2-&gt;3)</span><br><span class="line">[3-&gt;0] 的最短路径为 :(3-&gt;0)</span><br><span class="line">[3-&gt;1] 的最短路径为 :(3-&gt;0-&gt;1)</span><br><span class="line">[3-&gt;2] 的最短路径为 :(3-&gt;0-&gt;2)</span><br><span class="line">[3-&gt;3] 的最短路径为 :(3-&gt;3)</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><h3 id="核心算法"><a href="#核心算法" class="headerlink" title="核心算法"></a>核心算法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.floyed;</span><br><span class="line"></span><br><span class="line">public class Floyed &#123;</span><br><span class="line">    public static final int INF = -1;//无穷大/不可达</span><br><span class="line"></span><br><span class="line">    public static void calculateByFloyedAlgorithm(final int[][] distanceMatrix, final int pathMatrix[][]) &#123;</span><br><span class="line">        if (distanceMatrix != null) &#123;</span><br><span class="line">            for (int k = 0; k &lt; distanceMatrix.length; k++)</span><br><span class="line">                for (int i = 0; i &lt; distanceMatrix.length; i++)</span><br><span class="line">                    for (int j = 0; j &lt; distanceMatrix.length; j++) &#123;</span><br><span class="line">                        if (distanceMatrix[i][k] != Floyed.INF &amp;&amp; distanceMatrix[k][j] != Floyed.INF &amp;&amp; (distanceMatrix[i][j] == -1 || (distanceMatrix[i][j] &gt; distanceMatrix[i][k] + distanceMatrix[k][j]))) &#123;</span><br><span class="line">                            distanceMatrix[i][j] = distanceMatrix[i][k] + distanceMatrix[k][j];</span><br><span class="line">                            if (pathMatrix[i][j] == INF)</span><br><span class="line">                                pathMatrix[i][j] = k;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void printPath(final int[][] distanceMatrix, final int pathMatrix[][]) &#123;</span><br><span class="line">        if (pathMatrix != null &amp;&amp; distanceMatrix != null) &#123;</span><br><span class="line">            for (int i = 0; i &lt; pathMatrix.length; i++) &#123;</span><br><span class="line">                for (int j = 0; j &lt; pathMatrix.length; j++) &#123;</span><br><span class="line">                    System.out.print(&quot;\t[&quot; + i + &quot;-&gt;&quot; + j + &quot;] 的最短路径为 :&quot;);</span><br><span class="line">                    if (distanceMatrix[i][j] == INF) &#123;</span><br><span class="line">                        System.out.println(&quot;(不可达)&quot;);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        System.out.print(&quot;(&quot; + i + &quot;-&gt;&quot;);</span><br><span class="line">                        printPath(pathMatrix, i, j);</span><br><span class="line">                        System.out.println(j + &quot;)&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void printPath(int path[][], int i, int j) &#123;//递归输出路径</span><br><span class="line">        if (path != null &amp;&amp; path[i][j] != INF) &#123;</span><br><span class="line">            printPath(path, i, path[i][j]);</span><br><span class="line">            System.out.printf(&quot;%d-&gt;&quot;, path[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void printMatrix(final int[][] originalMatrix) &#123;</span><br><span class="line">        if (originalMatrix != null) &#123;</span><br><span class="line">            for (int[] itemMatrix : originalMatrix) &#123;</span><br><span class="line">                for (int itemValue : itemMatrix)</span><br><span class="line">                    System.out.printf(&quot;%6d&quot;, itemValue);</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.floyed.test;</span><br><span class="line"></span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import static krmao.algorithm.floyed.Floyed.INF;</span><br><span class="line"></span><br><span class="line">public class FloyedTest &#123;</span><br><span class="line">    @Test</span><br><span class="line">    public void testFloyed() &#123;</span><br><span class="line">        int originalMatrix[][] = new int[][]&#123;</span><br><span class="line">                &#123;0, 2, 6, 4&#125;,</span><br><span class="line">                &#123;INF, 0, 3, INF&#125;,</span><br><span class="line">                &#123;7, INF, 0, 1&#125;,</span><br><span class="line">                &#123;5, INF, 12, 0&#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        //记录点到点之间 经过哪一个点(保存这个点的名字) 使得距离更近,初始值INF表示不经过别的点中转</span><br><span class="line">        int pathMatrix[][] = new int[][]&#123;</span><br><span class="line">                &#123;INF, INF, INF, INF&#125;,</span><br><span class="line">                &#123;INF, INF, INF, INF&#125;,</span><br><span class="line">                &#123;INF, INF, INF, INF&#125;,</span><br><span class="line">                &#123;INF, INF, INF, INF&#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">        System.out.println(&quot;\t初始化原始点到点距离矩阵:&quot;);</span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">        krmao.algorithm.floyed.Floyed.printMatrix(originalMatrix);</span><br><span class="line">        krmao.algorithm.floyed.Floyed.calculateByFloyedAlgorithm(originalMatrix, pathMatrix);</span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">        System.out.println(&quot;\t经过 Floyed 算法处理之后的点到点最短距离矩阵:&quot;);</span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">        krmao.algorithm.floyed.Floyed.printMatrix(originalMatrix);</span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">        krmao.algorithm.floyed.Floyed.printPath(originalMatrix, pathMatrix);</span><br><span class="line">        System.out.println(&quot;--------------------------------------------------&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://developer.51cto.com/art/201403/433874.htm" target="_blank" rel="noopener">http://developer.51cto.com/art/201403/433874.htm</a><br><a href="http://www.cnblogs.com/skywang12345/p/3711532.html" target="_blank" rel="noopener">http://www.cnblogs.com/skywang12345/p/3711532.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>算法_00002_Dijkstra</title>
      <link href="/2018/11/19/%E7%AE%97%E6%B3%95_00002_Dijkstra/"/>
      <url>/2018/11/19/%E7%AE%97%E6%B3%95_00002_Dijkstra/</url>
      
        <content type="html"><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul><li><strong>Dijkstra算法</strong>是由荷兰计算机科学家<a href="http://wiki.mbalib.com/w/index.php?title=%E7%8B%84%E5%85%8B%E6%96%AF%E7%89%B9%E6%8B%89&amp;action=edit" target="_blank" rel="noopener">狄克斯特拉</a>（<a href="http://wiki.mbalib.com/wiki/Dijkstra" target="_blank" rel="noopener">Dijkstra</a>）于1959 年提出的，因此又叫狄克斯特拉算法。是从一个顶点到其余各顶点的最短路径算法，解决的是有向图中最短路径问题。</li></ul><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p><img src="http://upload-images.jianshu.io/upload_images/2062311-926a6bae20861cb3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Dijkstra算法图(来源:见文章结尾参考链接)"></p><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p><img src="http://upload-images.jianshu.io/upload_images/2062311-7799e871aa4e3116.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="邻接矩阵(来源:见文章结尾参考链接)"></p><h3 id="以起点D开始的演算过程"><a href="#以起点D开始的演算过程" class="headerlink" title="以起点D开始的演算过程"></a>以起点D开始的演算过程</h3><p><img src="http://upload-images.jianshu.io/upload_images/2062311-30b98cc4326939a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Dijkstra算法推演过程(来源:见文章结尾参考链接)"></p><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">初始化原始点到点距离矩阵:</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">     ┃     A     B     C     D     E     F     G</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">  A  ┃     0    12   INF   INF   INF    16    14</span><br><span class="line">  B  ┃    12     0    10   INF   INF     7   INF</span><br><span class="line">  C  ┃   INF    10     0     3     5     6   INF</span><br><span class="line">  D  ┃   INF   INF     3     0     4   INF   INF</span><br><span class="line">  E  ┃   INF   INF     5     4     0     2     8</span><br><span class="line">  F  ┃    16     7     6   INF     2     0     9</span><br><span class="line">  G  ┃    14   INF   INF   INF     8     9     0</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">初始化起点[D]到各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离(INF)</span><br><span class="line">[D-&gt;B]的距离(INF)</span><br><span class="line">[D-&gt;C]的距离(  3)</span><br><span class="line">[D-&gt;D]的距离(  0)</span><br><span class="line">[D-&gt;E]的距离(  4)</span><br><span class="line">[D-&gt;F]的距离(INF)</span><br><span class="line">[D-&gt;G]的距离(INF)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">开始执行 Dijkstra 算法:</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">标记[D]不参与下次循环</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离(INF)</span><br><span class="line">[D-&gt;B]的距离(INF)</span><br><span class="line">[D-&gt;C]的距离(  3)</span><br><span class="line">[D-&gt;E]的距离(  4)</span><br><span class="line">[D-&gt;F]的距离(INF)</span><br><span class="line">[D-&gt;G]的距离(INF)</span><br><span class="line">得出当前[D-&gt;C]的距离(  3)最短,标记[C]不参与下次循环,并计算判断当起点[D]在经过中间点[C]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">[D-&gt;C]的距离(  3) + [C-&gt;A]的距离(INF)得出[D-&gt;C-&gt;A]的距离(INF) ≥ [D-&gt;A]的累积计算的最短距离(INF)得出[D-&gt;A]的最短距离(INF)</span><br><span class="line">[D-&gt;C]的距离(  3) + [C-&gt;B]的距离( 10)得出[D-&gt;C-&gt;B]的距离( 13) &lt;  [D-&gt;B]的累积计算的最短距离(INF)得出[D-&gt;B]的最短距离( 13)</span><br><span class="line">[D-&gt;C]的距离(  3) + [C-&gt;E]的距离(  5)得出[D-&gt;C-&gt;E]的距离(  8) ≥ [D-&gt;E]的累积计算的最短距离(  4)得出[D-&gt;E]的最短距离(  4)</span><br><span class="line">[D-&gt;C]的距离(  3) + [C-&gt;F]的距离(  6)得出[D-&gt;C-&gt;F]的距离(  9) &lt;  [D-&gt;F]的累积计算的最短距离(INF)得出[D-&gt;F]的最短距离(  9)</span><br><span class="line">[D-&gt;C]的距离(  3) + [C-&gt;G]的距离(INF)得出[D-&gt;C-&gt;G]的距离(INF) ≥ [D-&gt;G]的累积计算的最短距离(INF)得出[D-&gt;G]的最短距离(INF)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离(INF)</span><br><span class="line">[D-&gt;B]的距离( 13)</span><br><span class="line">[D-&gt;E]的距离(  4)</span><br><span class="line">[D-&gt;F]的距离(  9)</span><br><span class="line">[D-&gt;G]的距离(INF)</span><br><span class="line">得出当前[D-&gt;E]的距离(  4)最短,标记[E]不参与下次循环,并计算判断当起点[D]在经过中间点[E]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">[D-&gt;E]的距离(  4) + [E-&gt;A]的距离(INF)得出[D-&gt;E-&gt;A]的距离(INF) ≥ [D-&gt;A]的累积计算的最短距离(INF)得出[D-&gt;A]的最短距离(INF)</span><br><span class="line">[D-&gt;E]的距离(  4) + [E-&gt;B]的距离(INF)得出[D-&gt;E-&gt;B]的距离(INF) ≥ [D-&gt;B]的累积计算的最短距离( 13)得出[D-&gt;B]的最短距离( 13)</span><br><span class="line">[D-&gt;E]的距离(  4) + [E-&gt;F]的距离(  2)得出[D-&gt;E-&gt;F]的距离(  6) &lt;  [D-&gt;F]的累积计算的最短距离(  9)得出[D-&gt;F]的最短距离(  6)</span><br><span class="line">[D-&gt;E]的距离(  4) + [E-&gt;G]的距离(  8)得出[D-&gt;E-&gt;G]的距离( 12) &lt;  [D-&gt;G]的累积计算的最短距离(INF)得出[D-&gt;G]的最短距离( 12)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离(INF)</span><br><span class="line">[D-&gt;B]的距离( 13)</span><br><span class="line">[D-&gt;F]的距离(  6)</span><br><span class="line">[D-&gt;G]的距离( 12)</span><br><span class="line">得出当前[D-&gt;F]的距离(  6)最短,标记[F]不参与下次循环,并计算判断当起点[D]在经过中间点[F]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">[D-&gt;F]的距离(  6) + [F-&gt;A]的距离( 16)得出[D-&gt;F-&gt;A]的距离( 22) &lt;  [D-&gt;A]的累积计算的最短距离(INF)得出[D-&gt;A]的最短距离( 22)</span><br><span class="line">[D-&gt;F]的距离(  6) + [F-&gt;B]的距离(  7)得出[D-&gt;F-&gt;B]的距离( 13) ≥ [D-&gt;B]的累积计算的最短距离( 13)得出[D-&gt;B]的最短距离( 13)</span><br><span class="line">[D-&gt;F]的距离(  6) + [F-&gt;G]的距离(  9)得出[D-&gt;F-&gt;G]的距离( 15) ≥ [D-&gt;G]的累积计算的最短距离( 12)得出[D-&gt;G]的最短距离( 12)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离( 22)</span><br><span class="line">[D-&gt;B]的距离( 13)</span><br><span class="line">[D-&gt;G]的距离( 12)</span><br><span class="line">得出当前[D-&gt;G]的距离( 12)最短,标记[G]不参与下次循环,并计算判断当起点[D]在经过中间点[G]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">[D-&gt;G]的距离( 12) + [G-&gt;A]的距离( 14)得出[D-&gt;G-&gt;A]的距离( 26) ≥ [D-&gt;A]的累积计算的最短距离( 22)得出[D-&gt;A]的最短距离( 22)</span><br><span class="line">[D-&gt;G]的距离( 12) + [G-&gt;B]的距离(INF)得出[D-&gt;G-&gt;B]的距离(INF) ≥ [D-&gt;B]的累积计算的最短距离( 13)得出[D-&gt;B]的最短距离( 13)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离( 22)</span><br><span class="line">[D-&gt;B]的距离( 13)</span><br><span class="line">得出当前[D-&gt;B]的距离( 13)最短,标记[B]不参与下次循环,并计算判断当起点[D]在经过中间点[B]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">[D-&gt;B]的距离( 13) + [B-&gt;A]的距离( 12)得出[D-&gt;B-&gt;A]的距离( 25) ≥ [D-&gt;A]的累积计算的最短距离( 22)得出[D-&gt;A]的最短距离( 22)</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">比较起点[D]到未被标记过的各顶点的距离:</span><br><span class="line">[D-&gt;A]的距离( 22)</span><br><span class="line">得出当前[D-&gt;A]的距离( 22)最短,标记[A]不参与下次循环,并计算判断当起点[D]在经过中间点[A]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">经过 Dijkstra 算法处理之后D到其他节点的最短路径:</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br><span class="line">[D-&gt;A]的最短路径为[D-&gt;E-&gt;F-&gt;A]        距离: 22</span><br><span class="line">[D-&gt;B]的最短路径为[D-&gt;C-&gt;B]           距离: 13</span><br><span class="line">[D-&gt;C]的最短路径为[D-&gt;C]              距离:  3</span><br><span class="line">[D-&gt;D]的最短路径为[D-&gt;D]              距离:  0</span><br><span class="line">[D-&gt;E]的最短路径为[D-&gt;E]              距离:  4</span><br><span class="line">[D-&gt;F]的最短路径为[D-&gt;E-&gt;F]           距离:  6</span><br><span class="line">[D-&gt;G]的最短路径为[D-&gt;E-&gt;G]           距离: 12</span><br><span class="line">━━━━━━━━━━━━━━━━━━━━━━━━━━━</span><br></pre></td></tr></table></figure><h3 id="核心算法"><a href="#核心算法" class="headerlink" title="核心算法"></a>核心算法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.dijkstra;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayDeque;</span><br><span class="line">import java.util.Queue;</span><br><span class="line"></span><br><span class="line">import krmao.algorithm.common.Vocabulary;</span><br><span class="line"></span><br><span class="line">import static krmao.algorithm.common.MatrixUtil.INF;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 一些思路</span><br><span class="line"> */</span><br><span class="line">public class Dijkstra &#123;</span><br><span class="line"></span><br><span class="line">    public static void calculateByDijkstraAlgorithm(int startIndex, final int[][] distanceMatrix, final int[] newStartToNodeDistance, final int pathPreNodeIndex[]) &#123;</span><br><span class="line">        Queue&lt;Integer&gt; markedQueue = new ArrayDeque&lt;Integer&gt;();</span><br><span class="line">        System.out.printf(&quot;标记[%s]不参与下次循环\n&quot;, Vocabulary.charAt(startIndex));</span><br><span class="line">        markedQueue.add(startIndex);</span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        while (markedQueue.size() &lt; distanceMatrix.length) &#123;//全部标记完,则循环结束</span><br><span class="line">            System.out.printf(&quot;比较起点[%s]到未被标记过的各顶点的距离:\n&quot;, Vocabulary.charAt(startIndex));</span><br><span class="line">            int minDistance = INF;</span><br><span class="line">            int minDistanceIndex = INF;</span><br><span class="line">            for (int j = 0; j &lt; distanceMatrix.length; j++) &#123;</span><br><span class="line">                if (!markedQueue.contains(j)) &#123;</span><br><span class="line">                    System.out.printf(&quot;[%c-&gt;%c]的距离(%3s)\n&quot;, Vocabulary.charAt(startIndex), Vocabulary.charAt(j), newStartToNodeDistance[j] == INF ? &quot;INF&quot; : newStartToNodeDistance[j]);</span><br><span class="line">                    if (newStartToNodeDistance[j] != INF &amp;&amp; (minDistance == INF || newStartToNodeDistance[j] &lt; minDistance)) &#123;</span><br><span class="line">                        minDistance = newStartToNodeDistance[j];</span><br><span class="line">                        minDistanceIndex = j;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (minDistanceIndex != INF &amp;&amp; newStartToNodeDistance[minDistanceIndex] != INF) &#123;</span><br><span class="line">                System.out.printf(&quot;得出当前[%c-&gt;%c]的距离(%3d)最短,标记[%s]不参与下次循环,并计算判断当起点[%s]在经过中间点[%s]的情况下到达未被标记过的各顶点的距离是否变短,如果变短则更新最短距离):\n&quot;, Vocabulary.charAt(startIndex), Vocabulary.charAt(minDistanceIndex), minDistance, Vocabulary.charAt(minDistanceIndex), Vocabulary.charAt(startIndex), Vocabulary.charAt(minDistanceIndex));</span><br><span class="line">                markedQueue.add(minDistanceIndex);</span><br><span class="line"></span><br><span class="line">                for (int currentThirdIndex = 0; currentThirdIndex &lt; distanceMatrix.length; currentThirdIndex++) &#123;</span><br><span class="line">                    if (!markedQueue.contains(currentThirdIndex)) &#123;</span><br><span class="line">                        int oldStartToThirdDistance = newStartToNodeDistance[currentThirdIndex];</span><br><span class="line">                        if (distanceMatrix[currentThirdIndex][minDistanceIndex] != INF) &#123;</span><br><span class="line">                            if (newStartToNodeDistance[currentThirdIndex] == INF || newStartToNodeDistance[currentThirdIndex] &gt; distanceMatrix[currentThirdIndex][minDistanceIndex] + newStartToNodeDistance[minDistanceIndex]) &#123;</span><br><span class="line">                                int startToThirdDistance = distanceMatrix[currentThirdIndex][minDistanceIndex] + newStartToNodeDistance[minDistanceIndex];</span><br><span class="line">                                printLog(startIndex, minDistanceIndex, newStartToNodeDistance[minDistanceIndex], currentThirdIndex, distanceMatrix[currentThirdIndex][minDistanceIndex], oldStartToThirdDistance, startToThirdDistance, &quot; &lt;  &quot;);</span><br><span class="line">                                newStartToNodeDistance[currentThirdIndex] = startToThirdDistance;</span><br><span class="line">                                pathPreNodeIndex[currentThirdIndex] = minDistanceIndex;</span><br><span class="line">                            &#125; else</span><br><span class="line">                                printLog(startIndex, minDistanceIndex, newStartToNodeDistance[minDistanceIndex], currentThirdIndex, distanceMatrix[currentThirdIndex][minDistanceIndex], oldStartToThirdDistance, newStartToNodeDistance[currentThirdIndex], &quot; ≥ &quot;);</span><br><span class="line">                        &#125; else</span><br><span class="line">                            printLog(startIndex, minDistanceIndex, newStartToNodeDistance[minDistanceIndex], currentThirdIndex, distanceMatrix[currentThirdIndex][minDistanceIndex], oldStartToThirdDistance, newStartToNodeDistance[currentThirdIndex], &quot; ≥ &quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void processPath(StringBuffer pathBuffer, final int pathPreNodeIndex[], int index) &#123;</span><br><span class="line">        if (pathPreNodeIndex[index] != INF) &#123;</span><br><span class="line">            processPath(pathBuffer, pathPreNodeIndex, pathPreNodeIndex[index]);</span><br><span class="line">            pathBuffer.append(Vocabulary.charAt(pathPreNodeIndex[index])).append(&quot;-&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void printPath(int startIndex, int matrixLength, int[] newStartToNodeDistance, final int pathPreNodeIndex[]) &#123;</span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        for (int i = 0; i &lt; matrixLength; i++) &#123;</span><br><span class="line">            StringBuffer pathBuffer = new StringBuffer(&quot;[&quot;).append(Vocabulary.charAt(startIndex)).append(&quot;-&gt;&quot;);</span><br><span class="line">            processPath(pathBuffer, pathPreNodeIndex, i);</span><br><span class="line">            pathBuffer.append(Vocabulary.charAt(i)).append(&quot;]&quot;);</span><br><span class="line">            System.out.printf(&quot;[%c-&gt;%c]的最短路径为\t%-20s距离:%3d\n&quot;, Vocabulary.charAt(startIndex), Vocabulary.charAt(i), pathBuffer, newStartToNodeDistance[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void printLog(int startIndex, int currentMinDistanceIndex, int startToMinDistance, int currentThirdIndex, int minToThirdDistance, int oldStartToThirdDistance, int newStartToThirdDistance, String symbol) &#123;</span><br><span class="line">        int tmpStartToMinToThirdDistance = startToMinDistance == INF || minToThirdDistance == INF ? INF : startToMinDistance + minToThirdDistance;</span><br><span class="line">        String tmpStartToMinToThirdDistanceStr = tmpStartToMinToThirdDistance == INF ? &quot;INF&quot; : String.valueOf(tmpStartToMinToThirdDistance);</span><br><span class="line">        System.out.printf(&quot;[%c-&gt;%c]的距离(%3s) + [%c-&gt;%c]的距离(%3s)&quot;</span><br><span class="line">                        + &quot;\t得出[%c-&gt;%c-&gt;%c]的距离(%3s)%s[%c-&gt;%c]的累积计算的最短距离(%3s)&quot;</span><br><span class="line">                        + &quot;\t得出[%c-&gt;%c]的最短距离(%3s)\n&quot;,</span><br><span class="line">                Vocabulary.charAt(startIndex), Vocabulary.charAt(currentMinDistanceIndex), startToMinDistance == INF ? &quot;INF&quot; : startToMinDistance, Vocabulary.charAt(currentMinDistanceIndex), Vocabulary.charAt(currentThirdIndex), minToThirdDistance == INF ? &quot;INF&quot; : minToThirdDistance</span><br><span class="line">                , Vocabulary.charAt(startIndex), Vocabulary.charAt(currentMinDistanceIndex), Vocabulary.charAt(currentThirdIndex), tmpStartToMinToThirdDistanceStr, symbol, Vocabulary.charAt(startIndex), Vocabulary.charAt(currentThirdIndex), oldStartToThirdDistance == INF ? &quot;INF&quot; : oldStartToThirdDistance</span><br><span class="line">                , Vocabulary.charAt(startIndex), Vocabulary.charAt(currentThirdIndex), newStartToThirdDistance == INF ? &quot;INF&quot; : newStartToThirdDistance</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###单元测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package krmao.algorithm.dijkstra.test;</span><br><span class="line"></span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import krmao.algorithm.common.MatrixUtil;</span><br><span class="line">import krmao.algorithm.common.Vocabulary;</span><br><span class="line"></span><br><span class="line">import static krmao.algorithm.floyed.Floyed.INF;</span><br><span class="line"></span><br><span class="line">public class DijkstraTest &#123;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testDijkstra() &#123;</span><br><span class="line">        int originalMatrix[][] = new int[][]&#123;</span><br><span class="line">             /*A*//*B*//*C*//*D*//*E*//*F*//*G*/</span><br><span class="line">      /*A*/ &#123;0, 12, INF, INF, INF, 16, 14&#125;,</span><br><span class="line">      /*B*/ &#123;12, 0, 10, INF, INF, 7, INF&#125;,</span><br><span class="line">      /*C*/ &#123;INF, 10, 0, 3, 5, 6, INF&#125;,</span><br><span class="line">      /*D*/ &#123;INF, INF, 3, 0, 4, INF, INF&#125;,</span><br><span class="line">      /*E*/ &#123;INF, INF, 5, 4, 0, 2, 8&#125;,</span><br><span class="line">      /*F*/ &#123;16, 7, 6, INF, 2, 0, 9&#125;,</span><br><span class="line">      /*G*/ &#123;14, INF, INF, INF, 8, 9, 0&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        int pathPreNodeIndex[] = new int[originalMatrix.length];</span><br><span class="line">        int newStartToNodeDistance[] = new int[originalMatrix.length];</span><br><span class="line">        char startNode = &apos;D&apos;;</span><br><span class="line">        int startIndex = Vocabulary.indexFrom(startNode);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        System.out.println(&quot;初始化原始点到点距离矩阵:&quot;);</span><br><span class="line">        MatrixUtil.printMatrix(originalMatrix);</span><br><span class="line">        System.out.printf(&quot;初始化起点[%s]到各顶点的距离:\n&quot;, Vocabulary.charAt(startIndex));</span><br><span class="line">        System.arraycopy(originalMatrix[startIndex], 0, newStartToNodeDistance, 0, originalMatrix.length);</span><br><span class="line">        for (int j = 0; j &lt; originalMatrix.length; j++) &#123;</span><br><span class="line">            pathPreNodeIndex[j] = INF;//借着这个循环初始化前向节点</span><br><span class="line">            System.out.printf(&quot;[%c-&gt;%c]的距离(%3s)\n&quot;, Vocabulary.charAt(startIndex), Vocabulary.charAt(j), newStartToNodeDistance[j] == INF ? &quot;INF&quot; : newStartToNodeDistance[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        System.out.println(&quot;开始执行 Dijkstra 算法:&quot;);</span><br><span class="line">        System.out.println(&quot;━━━━━━━━━━━━━━━━━━━━━━━━━━━&quot;);</span><br><span class="line">        krmao.algorithm.dijkstra.Dijkstra.calculateByDijkstraAlgorithm(startIndex, originalMatrix, newStartToNodeDistance, pathPreNodeIndex);</span><br><span class="line">        System.out.printf(&quot;经过 Dijkstra 算法处理之后%c到其他节点的最短路径:\n&quot;, startNode);</span><br><span class="line">        krmao.algorithm.dijkstra.Dijkstra.printPath(startIndex, originalMatrix.length, newStartToNodeDistance, pathPreNodeIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="涉及到的工具类"><a href="#涉及到的工具类" class="headerlink" title="涉及到的工具类"></a>涉及到的工具类</h3><p><a href="http://www.jianshu.com/p/a6f34f5f8cfa" target="_blank" rel="noopener">Vocabulary</a><br><a href="http://www.jianshu.com/p/a6f34f5f8cfa" target="_blank" rel="noopener">MatrixUtil</a></p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://www.cnblogs.com/skywang12345/p/3711512.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="noopener">http://www.cnblogs.com/skywang12345/p/3711512.html?utm_source=tuicool&amp;utm_medium=referral</a><br><a href="http://blog.sina.com.cn/s/blog_8fe28e630102wwye.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_8fe28e630102wwye.html</a><br><a href="http://wiki.mbalib.com/wiki/Dijkstra%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">http://wiki.mbalib.com/wiki/Dijkstra%E7%AE%97%E6%B3%95</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>算法_00003_约瑟夫环</title>
      <link href="/2018/11/19/%E7%AE%97%E6%B3%95_00003_%E7%BA%A6%E7%91%9F%E5%A4%AB%E7%8E%AF/"/>
      <url>/2018/11/19/%E7%AE%97%E6%B3%95_00003_%E7%BA%A6%E7%91%9F%E5%A4%AB%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<h3 id="1-总结"><a href="#1-总结" class="headerlink" title="1 总结"></a>1 总结</h3><p>有 <strong>n</strong> 个打算杀身成仁的犹太人(<em>将军为约瑟夫</em>)商量后决定分别从黑箱子里抽签(<em>编号是连续的分别为 1,2,3…n, 在数组中下标即为 0,1,2…n-1</em>), 然后按编号顺序围成一个圈, 随机取一个数 <strong>m</strong> , 不断的依次杀死报数为 <strong>m</strong> (<em>即下标为m-1</em>)的人, 求最后一个报数为 <strong>m</strong> 的人编号(<em>自己有预谋的拿到这个编号,就可以活下来</em>)</p><ol><li>第一个杀死的人为第一个抽签为 <strong>m</strong> (<em>下标为m-1</em>) 的人</li><li>最后一个人在该轮的下标肯定为 <strong>0</strong></li></ol><ul><li>上一轮的结果f(n-1) + 报数的值 m 取模 这一轮的总数 n</li><li><strong>f(n)</strong>  即有 <strong>n</strong> 个人从 下标为<strong>m-1</strong>依次报数, 将报数为<strong>m</strong>的人杀掉, 求最后一个报数为m(最后一个可以活着)的人的下标<ul><li>注意报的数是从 <strong>1</strong> 开始到 <strong>m</strong>, 所以报数为m的人的下标为 m-1, 毕竟数组的下标从0开始<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">即 n 个人里面从 下标为(m-1)的人从1开始依次报数(1,2...m) 最后一个报数为m的人即为活着的人的 下标</span><br><span class="line">f(n) = (f(n-1) + m) % n</span><br></pre></td></tr></table></figure></li></ul></li></ul><p><a href="https://leetcode-cn.com/playground/93L4SBcb" target="_blank" rel="noopener">https://leetcode-cn.com/playground/93L4SBcb</a></p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>大致过程如图下：<br><img src="http://upload-images.jianshu.io/upload_images/2062311-3a243e97a1545608?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="参考大神文章中提到一个容易理解的解释 [https://blog.csdn.net/tingyun_say/article/details/52343897](https://blog.csdn.net/tingyun_say/article/details/52343897)"></p><p>那么我们知道是这么得到的新的队列，那么也很容易知道怎么反推了：<br>反观如上的变化情况，都是减去一个q，所以：<br><strong>变回去的公式如下：old = (new + q) % n</strong><br>这里的old和new指的是下标，n指的是总共有多少人</p><p>知道了怎么推出之前的下标，那么也就可以一步步递推回去得到开始的队列或者从小推到大得到最后剩余的结果。<br><strong>最后再做一道实际点的例子，求J2(4):</strong></p><p>J2(1) = 0<br>J2(2) = (J2(1) + 2) % 2 = 0<br>J2(3) = (J2(2) + 2) % 3 = 2<br>J2(4) = (J2(3) + 2) % 4 = 0</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://blog.csdn.net/tingyun_say/article/details/52343897" target="_blank" rel="noopener">https://blog.csdn.net/tingyun_say/article/details/52343897</a></p><p><a href="https://www.zhihu.com/question/23331384" target="_blank" rel="noopener">https://www.zhihu.com/question/23331384</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>算法_00004_快速排序</title>
      <link href="/2018/11/19/%E7%AE%97%E6%B3%95_00004_%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/"/>
      <url>/2018/11/19/%E7%AE%97%E6%B3%95_00004_%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public class QuickSort &#123;</span><br><span class="line"></span><br><span class="line">    private static void quickSort(final int array[], final int originLeft, final int originRight) &#123;</span><br><span class="line"></span><br><span class="line">        if (originLeft &lt; originRight) &#123;</span><br><span class="line"></span><br><span class="line">            int baseValue = array[originLeft];</span><br><span class="line">            int tmpLeft = originLeft;</span><br><span class="line">            int tmpRight = originRight;</span><br><span class="line"></span><br><span class="line">            while (tmpLeft != tmpRight) &#123;</span><br><span class="line"></span><br><span class="line">                while (tmpLeft &lt; tmpRight &amp;&amp; array[tmpRight] &gt;= baseValue) tmpRight--;</span><br><span class="line">                array[tmpLeft] = array[tmpRight];</span><br><span class="line"></span><br><span class="line">                while (tmpLeft &lt; tmpRight &amp;&amp; array[tmpLeft] &lt;= baseValue) tmpLeft++;</span><br><span class="line">                array[tmpRight] = array[tmpLeft];</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            array[tmpRight] = baseValue;</span><br><span class="line">            quickSort(array, originLeft, tmpLeft - 1);</span><br><span class="line">            quickSort(array, tmpRight + 1, originRight);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        int array[] = &#123;10, 5, 4, 1, 5, 2, 7, 3, 0, 4, 9, 6, 8&#125;;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;排序之前：&quot;);</span><br><span class="line">        for (int element : array) System.out.print(element + &quot; &quot;);</span><br><span class="line"></span><br><span class="line">        quickSort(array, 0, array.length - 1);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;\n排序之后：&quot;);</span><br><span class="line">        for (int element : array) System.out.print(element + &quot; &quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://www.cnblogs.com/MOBIN/p/4681369.html" target="_blank" rel="noopener">https://www.cnblogs.com/MOBIN/p/4681369.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
  
  
    
    <entry>
      <title>一些产品</title>
      <link href="/products/index.html"/>
      <url>/products/index.html</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">安卓</th><th style="text-align:center">苹果</th><th style="text-align:center">网页</th><th style="text-align:center">后台</th><th style="text-align:center">管理系统</th><th style="text-align:center">公众号</th><th style="text-align:center">小程序</th></tr></thead><tbody><tr><td style="text-align:center">吉多家园</td><td style="text-align:center">y</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">y</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">n</td></tr><tr><td style="text-align:center">菜仓生鲜</td><td style="text-align:center">y</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">y</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">n</td></tr><tr><td style="text-align:center">易马股权</td><td style="text-align:center">y</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td></tr><tr><td style="text-align:center">北京地铁巡检</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td></tr><tr><td style="text-align:center">北京自然博物馆</td><td style="text-align:center">y</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td><td style="text-align:center">n</td></tr></tbody></table><h2 id="1-吉多家园-下载链接"><a href="#1-吉多家园-下载链接" class="headerlink" title="1 吉多家园 下载链接"></a>1 吉多家园 <a href="http://www.jiduojia.com/" target="_blank" rel="noopener">下载链接</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">吉多家园app是一款集合了邻里社交、商超购物、二手市场、房产买卖和社区物业服务，并且还有</span><br><span class="line">方便的记事和提醒等功能的移动应用。未来我们会为建设智慧社区添加更多功能，大家快来加入我们，</span><br><span class="line">让我们为社区和生活创造更多价值!</span><br></pre></td></tr></table></figure><div style="overflow-x:scroll;width:100%;"><br>    <div style="width:1000px;"><br>        <div style="float:left;border:solid 2px #333;"><img src="http://image1.mdpda.com/picture.php?picurl=aHR0cDovL2YuaGlwaG90b3MuYmRpbWcuY29tL3dpc2VnYW1lL3BpYy9pdGVtL2MyOGI4N2Q2Mjc3ZjllMmZhMjNkMmZkODE2MzBlOTI0Yjk5OWYzZDIuanBn&" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://image1.mdpda.com/picture.php?picurl=aHR0cDovL2EuaGlwaG90b3MuYmRpbWcuY29tL3dpc2VnYW1lL3BpYy9pdGVtL2ZkMmYwNzA4MjgzODFmMzA0MTExYmY3OWEwMDE0YzA4NmYwNmYwZDIuanBn&" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://image1.mdpda.com/picture.php?picurl=aHR0cDovL2guaGlwaG90b3MuYmRpbWcuY29tL3dpc2VnYW1lL3BpYy9pdGVtLzJmMDg2ZTA2MWQ5NTBhN2JhZDU4N2MxNDAzZDE2MmQ5ZjNkM2M5ZjUuanBn&" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://image1.mdpda.com/picture.php?picurl=aHR0cDovL2cuaGlwaG90b3MuYmRpbWcuY29tL3dpc2VnYW1lL3BpYy9pdGVtLzVlNmQ1NWZiYjJmYjQzMTZhYmQ4NDlhYTI5YTQ0NjIzMDhmN2QzMWYuanBn&" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://image1.mdpda.com/picture.php?picurl=aHR0cDovL2IuaGlwaG90b3MuYmRpbWcuY29tL3dpc2VnYW1lL3BpYy9pdGVtLzIwMTY2ZDIyNGY0YTIwYTQ4ZmQ5MGYxNzk5NTI5ODIyNzMwZWQwMWYuanBn&" width="196px"></div><br>    </div><br></div><h2 id="2-菜仓生鲜-下载链接"><a href="#2-菜仓生鲜-下载链接" class="headerlink" title="2 菜仓生鲜 下载链接"></a>2 菜仓生鲜 <a href="http://www.onlinedown.net/soft/1211129.htm" target="_blank" rel="noopener">下载链接</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在居住社区范围内每周进行一次集中采购，包括水果、生鲜蔬菜等，在社区范围内每周收集订单后在</span><br><span class="line">固定的一天进行送货，由于集中采购并集中送货可以节约很多成本，客户也将以更优惠的价格购买到</span><br><span class="line">我们的商品。</span><br></pre></td></tr></table></figure><div style="overflow-x:scroll;width:100%;"><br>    <div style="width:1000px;"><br>        <div style="float:left;border:solid 2px #333;"><img src="http://src.onlinedown.net/images/h_iphone_imges/replace/180228_2019136.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://src.onlinedown.net/images/h_iphone_imges/replace/180228_1819135.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://src.onlinedown.net/images/h_iphone_imges/replace/180228_2119137.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://src.onlinedown.net/images/h_iphone_imges/replace/180228_2219139.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="http://src.onlinedown.net/images/h_iphone_imges/replace/180228_2119138.jpg" width="196px"></div><br>    </div><br></div><h2 id="3-易马股权-下载链接"><a href="#3-易马股权-下载链接" class="headerlink" title="3 易马股权 下载链接"></a>3 易马股权 <a href="https://www.pgyer.com/mV9i" target="_blank" rel="noopener">下载链接</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">展示一些资讯</span><br></pre></td></tr></table></figure><h2 id="4-北京地铁巡检"><a href="#4-北京地铁巡检" class="headerlink" title="4 北京地铁巡检"></a>4 北京地铁巡检</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">帮助地铁巡检员离线同步通过二维码检查记录地铁设备故障问题</span><br></pre></td></tr></table></figure><h2 id="5-北京自然博物馆-下载链接"><a href="#5-北京自然博物馆-下载链接" class="headerlink" title="5 北京自然博物馆 下载链接"></a>5 北京自然博物馆 <a href="https://m.paopaoche.net/xia/360191" target="_blank" rel="noopener">下载链接</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">北京自然博物馆app基于用户自带设备（智能手机、平板电脑）采用移动互联网、wifi定位等技术，</span><br><span class="line">融合线上和现场服务，实现导览、导航、签到、交流等多样的功能，利用新兴数字手段把自然博物馆</span><br><span class="line">参观提升到新的高度，有助于提高北京自然博物馆服务水平、管理水准和教育功能，加深对观众的深</span><br><span class="line">度体验服务，扩大博物馆宣传力度，提升北京自然博物馆品牌形象。</span><br></pre></td></tr></table></figure><div style="overflow-x:scroll;width:100%;"><br>    <div style="width:600px;"><br>        <div style="float:left;border:solid 2px #333;"><img src="https://thumb31.jfcdns.com/up/2017-12/20171212165723108100.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="https://thumb31.jfcdns.com/up/2017-12/20171212165723320420.jpg" width="196px"></div><div style="float:left;border:solid 2px #333;"><img src="https://thumb31.jfcdns.com/up/2017-12/20171212165724108200.jpg" width="196px"></div><br>    </div><br></div>]]></content>
      
    </entry>
    
  
</search>
